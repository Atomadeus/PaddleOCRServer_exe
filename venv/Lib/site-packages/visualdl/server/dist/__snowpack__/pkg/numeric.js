import{c as createCommonjsModule,a as commonjsGlobal}from"./common/_commonjsHelpers-b3efd043.js";var numeric1_2_6=createCommonjsModule(function(module,exports){var numeric=exports;typeof commonjsGlobal!="undefined"&&(commonjsGlobal.numeric=numeric),numeric.version="1.2.6",numeric.bench=function(e,t){var r,u,i,o;for(typeof t=="undefined"&&(t=15),i=.5,r=new Date;;){for(i*=2,o=i;o>3;o-=4)e(),e(),e(),e();for(;o>0;)e(),o--;if(u=new Date,u-r>t)break}for(o=i;o>3;o-=4)e(),e(),e(),e();for(;o>0;)e(),o--;return u=new Date,1e3*(3*i-1)/(u-r)},numeric._myIndexOf=function(e){var t=this.length,r;for(r=0;r<t;++r)if(this[r]===e)return r;return-1},numeric.myIndexOf=Array.prototype.indexOf?Array.prototype.indexOf:numeric._myIndexOf,numeric.Function=Function,numeric.precision=4,numeric.largeArray=50,numeric.prettyPrint=function(e){function t(i){if(i===0)return"0";if(isNaN(i))return"NaN";if(i<0)return"-"+t(-i);if(isFinite(i)){var o=Math.floor(Math.log(i)/Math.log(10)),n=i/Math.pow(10,o),f=n.toPrecision(numeric.precision);return parseFloat(f)===10&&(o++,n=1,f=n.toPrecision(numeric.precision)),parseFloat(f).toString()+"e"+o.toString()}return"Infinity"}var r=[];function u(i){var o;if(typeof i=="undefined")return r.push(Array(numeric.precision+8).join(" ")),!1;if(typeof i=="string")return r.push('"'+i+'"'),!1;if(typeof i=="boolean")return r.push(i.toString()),!1;if(typeof i=="number"){var n=t(i),f=i.toPrecision(numeric.precision),a=parseFloat(i.toString()).toString(),m=[n,f,a,parseFloat(f).toString(),parseFloat(a).toString()];for(o=1;o<m.length;o++)m[o].length<n.length&&(n=m[o]);return r.push(Array(numeric.precision+8-n.length).join(" ")+n),!1}if(i===null)return r.push("null"),!1;if(typeof i=="function"){r.push(i.toString());var c=!1;for(o in i)i.hasOwnProperty(o)&&(c?r.push(`,
`):r.push(`
{`),c=!0,r.push(o),r.push(`: 
`),u(i[o]));return c&&r.push(`}
`),!0}if(i instanceof Array){if(i.length>numeric.largeArray)return r.push("...Large Array..."),!0;var c=!1;for(r.push("["),o=0;o<i.length;o++)o>0&&(r.push(","),c&&r.push(`
 `)),c=u(i[o]);return r.push("]"),!0}r.push("{");var c=!1;for(o in i)i.hasOwnProperty(o)&&(c&&r.push(`,
`),c=!0,r.push(o),r.push(`: 
`),u(i[o]));return r.push("}"),!0}return u(e),r.join("")},numeric.parseDate=function(e){function t(r){if(typeof r=="string")return Date.parse(r.replace(/-/g,"/"));if(!(r instanceof Array))throw new Error("parseDate: parameter must be arrays of strings");var u=[],i;for(i=0;i<r.length;i++)u[i]=t(r[i]);return u}return t(e)},numeric.parseFloat=function(e){function t(r){if(typeof r=="string")return parseFloat(r);if(!(r instanceof Array))throw new Error("parseFloat: parameter must be arrays of strings");var u=[],i;for(i=0;i<r.length;i++)u[i]=t(r[i]);return u}return t(e)},numeric.parseCSV=function(e){var t=e.split(`
`),r,u,i=[],o=/(([^'",]*)|('[^']*')|("[^"]*")),/g,n=/^\s*(([+-]?[0-9]+(\.[0-9]*)?(e[+-]?[0-9]+)?)|([+-]?[0-9]*(\.[0-9]+)?(e[+-]?[0-9]+)?))\s*$/,f=function(v){return v.substr(0,v.length-1)},a=0;for(u=0;u<t.length;u++){var m=(t[u]+",").match(o),c;if(m.length>0){for(i[a]=[],r=0;r<m.length;r++)c=f(m[r]),n.test(c)?i[a][r]=parseFloat(c):i[a][r]=c;a++}}return i},numeric.toCSV=function(e){var t=numeric.dim(e),r,u,i,o,n;for(i=t[0],t[1],n=[],r=0;r<i;r++){for(o=[],u=0;u<i;u++)o[u]=e[r][u].toString();n[r]=o.join(", ")}return n.join(`
`)+`
`},numeric.getURL=function(e){var t=new XMLHttpRequest;return t.open("GET",e,!1),t.send(),t},numeric.imageURL=function(e){function t(B){var D=B.length,A,y,b,g,j,l,F,E,M="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",_="";for(A=0;A<D;A+=3)y=B[A],b=B[A+1],g=B[A+2],j=y>>2,l=((y&3)<<4)+(b>>4),F=((b&15)<<2)+(g>>6),E=g&63,A+1>=D?F=E=64:A+2>=D&&(E=64),_+=M.charAt(j)+M.charAt(l)+M.charAt(F)+M.charAt(E);return _}function r(B,D,A){typeof D=="undefined"&&(D=0),typeof A=="undefined"&&(A=B.length);var y=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117],b=-1,g=0,j=B.length,l;for(l=D;l<A;l++)g=(b^B[l])&255,b=b>>>8^y[g];return b^-1}var u=e[0].length,i=e[0][0].length,o,n,f,a,m,c,v,h,s,p,d=[137,80,78,71,13,10,26,10,0,0,0,13,73,72,68,82,i>>24&255,i>>16&255,i>>8&255,i&255,u>>24&255,u>>16&255,u>>8&255,u&255,8,2,0,0,0,-1,-2,-3,-4,-5,-6,-7,-8,73,68,65,84,8,29];for(p=r(d,12,29),d[29]=p>>24&255,d[30]=p>>16&255,d[31]=p>>8&255,d[32]=p&255,o=1,n=0,v=0;v<u;v++){for(v<u-1?d.push(0):d.push(1),m=3*i+1+(v===0)&255,c=3*i+1+(v===0)>>8&255,d.push(m),d.push(c),d.push(~m&255),d.push(~c&255),v===0&&d.push(0),h=0;h<i;h++)for(f=0;f<3;f++)m=e[f][v][h],m>255?m=255:m<0?m=0:m=Math.round(m),o=(o+m)%65521,n=(n+o)%65521,d.push(m);d.push(0)}return s=(n<<16)+o,d.push(s>>24&255),d.push(s>>16&255),d.push(s>>8&255),d.push(s&255),a=d.length-41,d[33]=a>>24&255,d[34]=a>>16&255,d[35]=a>>8&255,d[36]=a&255,p=r(d,37),d.push(p>>24&255),d.push(p>>16&255),d.push(p>>8&255),d.push(p&255),d.push(0),d.push(0),d.push(0),d.push(0),d.push(73),d.push(69),d.push(78),d.push(68),d.push(174),d.push(66),d.push(96),d.push(130),"data:image/png;base64,"+t(d)},numeric._dim=function(e){for(var t=[];typeof e=="object";)t.push(e.length),e=e[0];return t},numeric.dim=function(e){var t,r;return typeof e=="object"?(t=e[0],typeof t=="object"?(r=t[0],typeof r=="object"?numeric._dim(e):[e.length,t.length]):[e.length]):[]},numeric.mapreduce=function(e,t){return Function("x","accum","_s","_k",'if(typeof accum === "undefined") accum = '+t+`;
if(typeof x === "number") { var xi = x; `+e+`; return accum; }
if(typeof _s === "undefined") _s = numeric.dim(x);
if(typeof _k === "undefined") _k = 0;
var _n = _s[_k];
var i,xi;
if(_k < _s.length-1) {
    for(i=_n-1;i>=0;i--) {
        accum = arguments.callee(x[i],accum,_s,_k+1);
    }    return accum;
}
for(i=_n-1;i>=1;i-=2) { 
    xi = x[i];
    `+e+`;
    xi = x[i-1];
    `+e+`;
}
if(i === 0) {
    xi = x[i];
    `+e+`
}
return accum;`)},numeric.mapreduce2=function(e,t){return Function("x",`var n = x.length;
var i,xi;
`+t+`;
for(i=n-1;i!==-1;--i) { 
    xi = x[i];
    `+e+`;
}
return accum;`)},numeric.same=function x(e,t){var r,u;if(!(e instanceof Array)||!(t instanceof Array)||(u=e.length,u!==t.length))return!1;for(r=0;r<u;r++)if(e[r]!==t[r])if(typeof e[r]=="object"){if(!x(e[r],t[r]))return!1}else return!1;return!0},numeric.rep=function(e,t,r){typeof r=="undefined"&&(r=0);var u=e[r],i=Array(u),o;if(r===e.length-1){for(o=u-2;o>=0;o-=2)i[o+1]=t,i[o]=t;return o===-1&&(i[0]=t),i}for(o=u-1;o>=0;o--)i[o]=numeric.rep(e,t,r+1);return i},numeric.dotMMsmall=function(e,t){var r,u,i,o,n,f,a,m,c,v,h;for(o=e.length,n=t.length,f=t[0].length,a=Array(o),r=o-1;r>=0;r--){for(m=Array(f),c=e[r],i=f-1;i>=0;i--){for(v=c[n-1]*t[n-1][i],u=n-2;u>=1;u-=2)h=u-1,v+=c[u]*t[u][i]+c[h]*t[h][i];u===0&&(v+=c[0]*t[0][i]),m[i]=v}a[r]=m}return a},numeric._getCol=function(e,t,r){var u=e.length,i;for(i=u-1;i>0;--i)r[i]=e[i][t],--i,r[i]=e[i][t];i===0&&(r[0]=e[0][t])},numeric.dotMMbig=function(e,t){var r=numeric._getCol,u=t.length,i=Array(u),o=e.length,n=t[0].length,f=new Array(o),a,m=numeric.dotVV,c,v;for(--u,--o,c=o;c!==-1;--c)f[c]=Array(n);for(--n,c=n;c!==-1;--c)for(r(t,c,i),v=o;v!==-1;--v)a=e[v],f[v][c]=m(a,i);return f},numeric.dotMV=function(e,t){var r=e.length,u=t.length,i,o=Array(r),n=numeric.dotVV;for(i=r-1;i>=0;i--)o[i]=n(e[i],t);return o},numeric.dotVM=function(e,t){var r,u,i,o,n,f,a;for(i=e.length,o=t[0].length,n=Array(o),u=o-1;u>=0;u--){for(f=e[i-1]*t[i-1][u],r=i-2;r>=1;r-=2)a=r-1,f+=e[r]*t[r][u]+e[a]*t[a][u];r===0&&(f+=e[0]*t[0][u]),n[u]=f}return n},numeric.dotVV=function(e,t){var r,u=e.length,i,o=e[u-1]*t[u-1];for(r=u-2;r>=1;r-=2)i=r-1,o+=e[r]*t[r]+e[i]*t[i];return r===0&&(o+=e[0]*t[0]),o},numeric.dot=function(e,t){var r=numeric.dim;switch(r(e).length*1e3+r(t).length){case 2002:return t.length<10?numeric.dotMMsmall(e,t):numeric.dotMMbig(e,t);case 2001:return numeric.dotMV(e,t);case 1002:return numeric.dotVM(e,t);case 1001:return numeric.dotVV(e,t);case 1e3:return numeric.mulVS(e,t);case 1:return numeric.mulSV(e,t);case 0:return e*t;default:throw new Error("numeric.dot only works on vectors and matrices")}},numeric.diag=function(e){var t,r,u,i=e.length,o=Array(i),n;for(t=i-1;t>=0;t--){for(n=Array(i),r=t+2,u=i-1;u>=r;u-=2)n[u]=0,n[u-1]=0;for(u>t&&(n[u]=0),n[t]=e[t],u=t-1;u>=1;u-=2)n[u]=0,n[u-1]=0;u===0&&(n[0]=0),o[t]=n}return o},numeric.getDiag=function(x){var e=Math.min(x.length,x[0].length),t,r=Array(e);for(t=e-1;t>=1;--t)r[t]=x[t][t],--t,r[t]=x[t][t];return t===0&&(r[0]=x[0][0]),r},numeric.identity=function(e){return numeric.diag(numeric.rep([e],1))},numeric.pointwise=function(e,t,r){typeof r=="undefined"&&(r="");var u=[],i,o=/\[i\]$/,n,f="",a=!1;for(i=0;i<e.length;i++)o.test(e[i])?(n=e[i].substring(0,e[i].length-3),f=n):n=e[i],n==="ret"&&(a=!0),u.push(n);return u[e.length]="_s",u[e.length+1]="_k",u[e.length+2]='if(typeof _s === "undefined") _s = numeric.dim('+f+`);
if(typeof _k === "undefined") _k = 0;
var _n = _s[_k];
var i`+(a?"":", ret = Array(_n)")+`;
if(_k < _s.length-1) {
    for(i=_n-1;i>=0;i--) ret[i] = arguments.callee(`+e.join(",")+`,_s,_k+1);
    return ret;
}
`+r+`
for(i=_n-1;i!==-1;--i) {
    `+t+`
}
return ret;`,Function.apply(null,u)},numeric.pointwise2=function(e,t,r){typeof r=="undefined"&&(r="");var u=[],i,o=/\[i\]$/,n,f="",a=!1;for(i=0;i<e.length;i++)o.test(e[i])?(n=e[i].substring(0,e[i].length-3),f=n):n=e[i],n==="ret"&&(a=!0),u.push(n);return u[e.length]="var _n = "+f+`.length;
var i`+(a?"":", ret = Array(_n)")+`;
`+r+`
for(i=_n-1;i!==-1;--i) {
`+t+`
}
return ret;`,Function.apply(null,u)},numeric._biforeach=function x(e,t,r,u,i){if(u===r.length-1){i(e,t);return}var o,n=r[u];for(o=n-1;o>=0;o--)x(typeof e=="object"?e[o]:e,typeof t=="object"?t[o]:t,r,u+1,i)},numeric._biforeach2=function x(e,t,r,u,i){if(u===r.length-1)return i(e,t);var o,n=r[u],f=Array(n);for(o=n-1;o>=0;--o)f[o]=x(typeof e=="object"?e[o]:e,typeof t=="object"?t[o]:t,r,u+1,i);return f},numeric._foreach=function x(e,t,r,u){if(r===t.length-1){u(e);return}var i,o=t[r];for(i=o-1;i>=0;i--)x(e[i],t,r+1,u)},numeric._foreach2=function x(e,t,r,u){if(r===t.length-1)return u(e);var i,o=t[r],n=Array(o);for(i=o-1;i>=0;i--)n[i]=x(e[i],t,r+1,u);return n},numeric.ops2={add:"+",sub:"-",mul:"*",div:"/",mod:"%",and:"&&",or:"||",eq:"===",neq:"!==",lt:"<",gt:">",leq:"<=",geq:">=",band:"&",bor:"|",bxor:"^",lshift:"<<",rshift:">>",rrshift:">>>"},numeric.opseq={addeq:"+=",subeq:"-=",muleq:"*=",diveq:"/=",modeq:"%=",lshifteq:"<<=",rshifteq:">>=",rrshifteq:">>>=",bandeq:"&=",boreq:"|=",bxoreq:"^="},numeric.mathfuns=["abs","acos","asin","atan","ceil","cos","exp","floor","log","round","sin","sqrt","tan","isNaN","isFinite"],numeric.mathfuns2=["atan2","pow","max","min"],numeric.ops1={neg:"-",not:"!",bnot:"~",clone:""},numeric.mapreducers={any:["if(xi) return true;","var accum = false;"],all:["if(!xi) return false;","var accum = true;"],sum:["accum += xi;","var accum = 0;"],prod:["accum *= xi;","var accum = 1;"],norm2Squared:["accum += xi*xi;","var accum = 0;"],norminf:["accum = max(accum,abs(xi));","var accum = 0, max = Math.max, abs = Math.abs;"],norm1:["accum += abs(xi)","var accum = 0, abs = Math.abs;"],sup:["accum = max(accum,xi);","var accum = -Infinity, max = Math.max;"],inf:["accum = min(accum,xi);","var accum = Infinity, min = Math.min;"]},function(){var x,e;for(x=0;x<numeric.mathfuns2.length;++x)e=numeric.mathfuns2[x],numeric.ops2[e]=e;for(x in numeric.ops2)if(numeric.ops2.hasOwnProperty(x)){e=numeric.ops2[x];var t,r,u="";numeric.myIndexOf.call(numeric.mathfuns2,x)!==-1?(u="var "+e+" = Math."+e+`;
`,t=function(i,o,n){return i+" = "+e+"("+o+","+n+")"},r=function(i,o){return i+" = "+e+"("+i+","+o+")"}):(t=function(i,o,n){return i+" = "+o+" "+e+" "+n},numeric.opseq.hasOwnProperty(x+"eq")?r=function(i,o){return i+" "+e+"= "+o}:r=function(i,o){return i+" = "+i+" "+e+" "+o}),numeric[x+"VV"]=numeric.pointwise2(["x[i]","y[i]"],t("ret[i]","x[i]","y[i]"),u),numeric[x+"SV"]=numeric.pointwise2(["x","y[i]"],t("ret[i]","x","y[i]"),u),numeric[x+"VS"]=numeric.pointwise2(["x[i]","y"],t("ret[i]","x[i]","y"),u),numeric[x]=Function(`var n = arguments.length, i, x = arguments[0], y;
var VV = numeric.`+x+"VV, VS = numeric."+x+"VS, SV = numeric."+x+`SV;
var dim = numeric.dim;
for(i=1;i!==n;++i) { 
  y = arguments[i];
  if(typeof x === "object") {
      if(typeof y === "object") x = numeric._biforeach2(x,y,dim(x),0,VV);
      else x = numeric._biforeach2(x,y,dim(x),0,VS);
  } else if(typeof y === "object") x = numeric._biforeach2(x,y,dim(y),0,SV);
  else `+r("x","y")+`
}
return x;
`),numeric[e]=numeric[x],numeric[x+"eqV"]=numeric.pointwise2(["ret[i]","x[i]"],r("ret[i]","x[i]"),u),numeric[x+"eqS"]=numeric.pointwise2(["ret[i]","x"],r("ret[i]","x"),u),numeric[x+"eq"]=Function(`var n = arguments.length, i, x = arguments[0], y;
var V = numeric.`+x+"eqV, S = numeric."+x+`eqS
var s = numeric.dim(x);
for(i=1;i!==n;++i) { 
  y = arguments[i];
  if(typeof y === "object") numeric._biforeach(x,y,s,0,V);
  else numeric._biforeach(x,y,s,0,S);
}
return x;
`)}for(x=0;x<numeric.mathfuns2.length;++x)e=numeric.mathfuns2[x],delete numeric.ops2[e];for(x=0;x<numeric.mathfuns.length;++x)e=numeric.mathfuns[x],numeric.ops1[e]=e;for(x in numeric.ops1)numeric.ops1.hasOwnProperty(x)&&(u="",e=numeric.ops1[x],numeric.myIndexOf.call(numeric.mathfuns,x)!==-1&&Math.hasOwnProperty(e)&&(u="var "+e+" = Math."+e+`;
`),numeric[x+"eqV"]=numeric.pointwise2(["ret[i]"],"ret[i] = "+e+"(ret[i]);",u),numeric[x+"eq"]=Function("x",'if(typeof x !== "object") return '+e+`x
var i;
var V = numeric.`+x+`eqV;
var s = numeric.dim(x);
numeric._foreach(x,s,0,V);
return x;
`),numeric[x+"V"]=numeric.pointwise2(["x[i]"],"ret[i] = "+e+"(x[i]);",u),numeric[x]=Function("x",'if(typeof x !== "object") return '+e+`(x)
var i;
var V = numeric.`+x+`V;
var s = numeric.dim(x);
return numeric._foreach2(x,s,0,V);
`));for(x=0;x<numeric.mathfuns.length;++x)e=numeric.mathfuns[x],delete numeric.ops1[e];for(x in numeric.mapreducers)numeric.mapreducers.hasOwnProperty(x)&&(e=numeric.mapreducers[x],numeric[x+"V"]=numeric.mapreduce2(e[0],e[1]),numeric[x]=Function("x","s","k",e[1]+`if(typeof x !== "object") {    xi = x;
`+e[0]+`;
    return accum;
}if(typeof s === "undefined") s = numeric.dim(x);
if(typeof k === "undefined") k = 0;
if(k === s.length-1) return numeric.`+x+`V(x);
var xi;
var n = x.length, i;
for(i=n-1;i!==-1;--i) {
   xi = arguments.callee(x[i]);
`+e[0]+`;
}
return accum;
`))}(),numeric.truncVV=numeric.pointwise(["x[i]","y[i]"],"ret[i] = round(x[i]/y[i])*y[i];","var round = Math.round;"),numeric.truncVS=numeric.pointwise(["x[i]","y"],"ret[i] = round(x[i]/y)*y;","var round = Math.round;"),numeric.truncSV=numeric.pointwise(["x","y[i]"],"ret[i] = round(x/y[i])*y[i];","var round = Math.round;"),numeric.trunc=function(e,t){return typeof e=="object"?typeof t=="object"?numeric.truncVV(e,t):numeric.truncVS(e,t):typeof t=="object"?numeric.truncSV(e,t):Math.round(e/t)*t},numeric.inv=function(e){var t=numeric.dim(e),r=Math.abs,u=t[0],i=t[1],o=numeric.clone(e),n,f,a=numeric.identity(u),m,c,v,h,s,e;for(h=0;h<i;++h){var p=-1,d=-1;for(v=h;v!==u;++v)s=r(o[v][h]),s>d&&(p=v,d=s);for(f=o[p],o[p]=o[h],o[h]=f,c=a[p],a[p]=a[h],a[h]=c,e=f[h],s=h;s!==i;++s)f[s]/=e;for(s=i-1;s!==-1;--s)c[s]/=e;for(v=u-1;v!==-1;--v)if(v!==h){for(n=o[v],m=a[v],e=n[h],s=h+1;s!==i;++s)n[s]-=f[s]*e;for(s=i-1;s>0;--s)m[s]-=c[s]*e,--s,m[s]-=c[s]*e;s===0&&(m[0]-=c[0]*e)}}return a},numeric.det=function(e){var t=numeric.dim(e);if(t.length!==2||t[0]!==t[1])throw new Error("numeric: det() only works on square matrices");var r=t[0],u=1,i,o,n,f=numeric.clone(e),a,m,c,v,h;for(o=0;o<r-1;o++){for(n=o,i=o+1;i<r;i++)Math.abs(f[i][o])>Math.abs(f[n][o])&&(n=i);for(n!==o&&(v=f[n],f[n]=f[o],f[o]=v,u*=-1),a=f[o],i=o+1;i<r;i++){for(m=f[i],c=m[o]/a[o],n=o+1;n<r-1;n+=2)h=n+1,m[n]-=a[n]*c,m[h]-=a[h]*c;n!==r&&(m[n]-=a[n]*c)}if(a[o]===0)return 0;u*=a[o]}return u*f[o][o]},numeric.transpose=function(e){var t,r,u=e.length,i=e[0].length,o=Array(i),n,f,a;for(r=0;r<i;r++)o[r]=Array(u);for(t=u-1;t>=1;t-=2){for(f=e[t],n=e[t-1],r=i-1;r>=1;--r)a=o[r],a[t]=f[r],a[t-1]=n[r],--r,a=o[r],a[t]=f[r],a[t-1]=n[r];r===0&&(a=o[0],a[t]=f[0],a[t-1]=n[0])}if(t===0){for(n=e[0],r=i-1;r>=1;--r)o[r][0]=n[r],--r,o[r][0]=n[r];r===0&&(o[0][0]=n[0])}return o},numeric.negtranspose=function(e){var t,r,u=e.length,i=e[0].length,o=Array(i),n,f,a;for(r=0;r<i;r++)o[r]=Array(u);for(t=u-1;t>=1;t-=2){for(f=e[t],n=e[t-1],r=i-1;r>=1;--r)a=o[r],a[t]=-f[r],a[t-1]=-n[r],--r,a=o[r],a[t]=-f[r],a[t-1]=-n[r];r===0&&(a=o[0],a[t]=-f[0],a[t-1]=-n[0])}if(t===0){for(n=e[0],r=i-1;r>=1;--r)o[r][0]=-n[r],--r,o[r][0]=-n[r];r===0&&(o[0][0]=-n[0])}return o},numeric._random=function x(e,t){var r,u=e[t],i=Array(u),o;if(t===e.length-1){for(o=Math.random,r=u-1;r>=1;r-=2)i[r]=o(),i[r-1]=o();return r===0&&(i[0]=o()),i}for(r=u-1;r>=0;r--)i[r]=x(e,t+1);return i},numeric.random=function(e){return numeric._random(e,0)},numeric.norm2=function(e){return Math.sqrt(numeric.norm2Squared(e))},numeric.linspace=function(e,t,r){if(typeof r=="undefined"&&(r=Math.max(Math.round(t-e)+1,1)),r<2)return r===1?[e]:[];var u,i=Array(r);for(r--,u=r;u>=0;u--)i[u]=(u*t+(r-u)*e)/r;return i},numeric.getBlock=function(e,t,r){var u=numeric.dim(e);function i(o,n){var f,a=t[n],m=r[n]-a,c=Array(m);if(n===u.length-1){for(f=m;f>=0;f--)c[f]=o[f+a];return c}for(f=m;f>=0;f--)c[f]=i(o[f+a],n+1);return c}return i(e,0)},numeric.setBlock=function(e,t,r,u){var i=numeric.dim(e);function o(n,f,a){var m,c=t[a],v=r[a]-c;if(a===i.length-1)for(m=v;m>=0;m--)n[m+c]=f[m];for(m=v;m>=0;m--)o(n[m+c],f[m],a+1)}return o(e,u,0),e},numeric.getRange=function(e,t,r){var u=t.length,i=r.length,o,n,f=Array(u),a,m;for(o=u-1;o!==-1;--o)for(f[o]=Array(i),a=f[o],m=e[t[o]],n=i-1;n!==-1;--n)a[n]=m[r[n]];return f},numeric.blockMatrix=function(e){var t=numeric.dim(e);if(t.length<4)return numeric.blockMatrix([e]);var r=t[0],u=t[1],i,o,n,f,a;for(i=0,o=0,n=0;n<r;++n)i+=e[n][0].length;for(f=0;f<u;++f)o+=e[0][f][0].length;var m=Array(i);for(n=0;n<i;++n)m[n]=Array(o);var c=0,v,h,s,p,d;for(n=0;n<r;++n){for(v=o,f=u-1;f!==-1;--f)for(a=e[n][f],v-=a[0].length,s=a.length-1;s!==-1;--s)for(d=a[s],h=m[c+s],p=d.length-1;p!==-1;--p)h[v+p]=d[p];c+=e[n][0].length}return m},numeric.tensor=function(e,t){if(typeof e=="number"||typeof t=="number")return numeric.mul(e,t);var r=numeric.dim(e),u=numeric.dim(t);if(r.length!==1||u.length!==1)throw new Error("numeric: tensor product is only defined for vectors");var i=r[0],o=u[0],n=Array(i),f,a,m,c;for(a=i-1;a>=0;a--){for(f=Array(o),c=e[a],m=o-1;m>=3;--m)f[m]=c*t[m],--m,f[m]=c*t[m],--m,f[m]=c*t[m],--m,f[m]=c*t[m];for(;m>=0;)f[m]=c*t[m],--m;n[a]=f}return n},numeric.T=function(e,t){this.x=e,this.y=t},numeric.t=function(e,t){return new numeric.T(e,t)},numeric.Tbinop=function(e,t,r,u,i){var o=numeric.indexOf;if(typeof i!="string"){var n;i="";for(n in numeric)numeric.hasOwnProperty(n)&&(e.indexOf(n)>=0||t.indexOf(n)>=0||r.indexOf(n)>=0||u.indexOf(n)>=0)&&n.length>1&&(i+="var "+n+" = numeric."+n+`;
`)}return Function(["y"],`var x = this;
if(!(y instanceof numeric.T)) { y = new numeric.T(y); }
`+i+`
if(x.y) {  if(y.y) {    return new numeric.T(`+u+`);
  }
  return new numeric.T(`+r+`);
}
if(y.y) {
  return new numeric.T(`+t+`);
}
return new numeric.T(`+e+`);
`)},numeric.T.prototype.add=numeric.Tbinop("add(x.x,y.x)","add(x.x,y.x),y.y","add(x.x,y.x),x.y","add(x.x,y.x),add(x.y,y.y)"),numeric.T.prototype.sub=numeric.Tbinop("sub(x.x,y.x)","sub(x.x,y.x),neg(y.y)","sub(x.x,y.x),x.y","sub(x.x,y.x),sub(x.y,y.y)"),numeric.T.prototype.mul=numeric.Tbinop("mul(x.x,y.x)","mul(x.x,y.x),mul(x.x,y.y)","mul(x.x,y.x),mul(x.y,y.x)","sub(mul(x.x,y.x),mul(x.y,y.y)),add(mul(x.x,y.y),mul(x.y,y.x))"),numeric.T.prototype.reciprocal=function(){var e=numeric.mul,t=numeric.div;if(this.y){var r=numeric.add(e(this.x,this.x),e(this.y,this.y));return new numeric.T(t(this.x,r),t(numeric.neg(this.y),r))}return new T(t(1,this.x))},numeric.T.prototype.div=function(e){if(e instanceof numeric.T||(e=new numeric.T(e)),e.y)return this.mul(e.reciprocal());var t=numeric.div;return this.y?new numeric.T(t(this.x,e.x),t(this.y,e.x)):new numeric.T(t(this.x,e.x))},numeric.T.prototype.dot=numeric.Tbinop("dot(x.x,y.x)","dot(x.x,y.x),dot(x.x,y.y)","dot(x.x,y.x),dot(x.y,y.x)","sub(dot(x.x,y.x),dot(x.y,y.y)),add(dot(x.x,y.y),dot(x.y,y.x))"),numeric.T.prototype.transpose=function(){var e=numeric.transpose,t=this.x,r=this.y;return r?new numeric.T(e(t),e(r)):new numeric.T(e(t))},numeric.T.prototype.transjugate=function(){var e=numeric.transpose,t=this.x,r=this.y;return r?new numeric.T(e(t),numeric.negtranspose(r)):new numeric.T(e(t))},numeric.Tunop=function(e,t,r){return typeof r!="string"&&(r=""),Function(`var x = this;
`+r+`
if(x.y) {  `+t+`;
}
`+e+`;
`)},numeric.T.prototype.exp=numeric.Tunop("return new numeric.T(ex)","return new numeric.T(mul(cos(x.y),ex),mul(sin(x.y),ex))","var ex = numeric.exp(x.x), cos = numeric.cos, sin = numeric.sin, mul = numeric.mul;"),numeric.T.prototype.conj=numeric.Tunop("return new numeric.T(x.x);","return new numeric.T(x.x,numeric.neg(x.y));"),numeric.T.prototype.neg=numeric.Tunop("return new numeric.T(neg(x.x));","return new numeric.T(neg(x.x),neg(x.y));","var neg = numeric.neg;"),numeric.T.prototype.sin=numeric.Tunop("return new numeric.T(numeric.sin(x.x))","return x.exp().sub(x.neg().exp()).div(new numeric.T(0,2));"),numeric.T.prototype.cos=numeric.Tunop("return new numeric.T(numeric.cos(x.x))","return x.exp().add(x.neg().exp()).div(2);"),numeric.T.prototype.abs=numeric.Tunop("return new numeric.T(numeric.abs(x.x));","return new numeric.T(numeric.sqrt(numeric.add(mul(x.x,x.x),mul(x.y,x.y))));","var mul = numeric.mul;"),numeric.T.prototype.log=numeric.Tunop("return new numeric.T(numeric.log(x.x));",`var theta = new numeric.T(numeric.atan2(x.y,x.x)), r = x.abs();
return new numeric.T(numeric.log(r.x),theta.x);`),numeric.T.prototype.norm2=numeric.Tunop("return numeric.norm2(x.x);",`var f = numeric.norm2Squared;
return Math.sqrt(f(x.x)+f(x.y));`),numeric.T.prototype.inv=function(){var e=this;if(typeof e.y=="undefined")return new numeric.T(numeric.inv(e.x));var t=e.x.length,r,u,i,o=numeric.identity(t),n=numeric.rep([t,t],0),f=numeric.clone(e.x),a=numeric.clone(e.y),m,c,v,h,s,p,d,B,r,u,i,D,A,y,b,g,j,l;for(r=0;r<t;r++){for(y=f[r][r],b=a[r][r],D=y*y+b*b,i=r,u=r+1;u<t;u++)y=f[u][r],b=a[u][r],A=y*y+b*b,A>D&&(i=u,D=A);for(i!==r&&(l=f[r],f[r]=f[i],f[i]=l,l=a[r],a[r]=a[i],a[i]=l,l=o[r],o[r]=o[i],o[i]=l,l=n[r],n[r]=n[i],n[i]=l),m=f[r],c=a[r],s=o[r],p=n[r],y=m[r],b=c[r],u=r+1;u<t;u++)g=m[u],j=c[u],m[u]=(g*y+j*b)/D,c[u]=(j*y-g*b)/D;for(u=0;u<t;u++)g=s[u],j=p[u],s[u]=(g*y+j*b)/D,p[u]=(j*y-g*b)/D;for(u=r+1;u<t;u++){for(v=f[u],h=a[u],d=o[u],B=n[u],y=v[r],b=h[r],i=r+1;i<t;i++)g=m[i],j=c[i],v[i]-=g*y-j*b,h[i]-=j*y+g*b;for(i=0;i<t;i++)g=s[i],j=p[i],d[i]-=g*y-j*b,B[i]-=j*y+g*b}}for(r=t-1;r>0;r--)for(s=o[r],p=n[r],u=r-1;u>=0;u--)for(d=o[u],B=n[u],y=f[u][r],b=a[u][r],i=t-1;i>=0;i--)g=s[i],j=p[i],d[i]-=y*g-b*j,B[i]-=y*j+b*g;return new numeric.T(o,n)},numeric.T.prototype.get=function(e){var t=this.x,r=this.y,u=0,i,o=e.length;if(r){for(;u<o;)i=e[u],t=t[i],r=r[i],u++;return new numeric.T(t,r)}for(;u<o;)i=e[u],t=t[i],u++;return new numeric.T(t)},numeric.T.prototype.set=function(e,t){var r=this.x,u=this.y,i=0,o,n=e.length,f=t.x,a=t.y;if(n===0)return a?this.y=a:u&&(this.y=void 0),this.x=r,this;if(a){for(u||(u=numeric.rep(numeric.dim(r),0),this.y=u);i<n-1;)o=e[i],r=r[o],u=u[o],i++;return o=e[i],r[o]=f,u[o]=a,this}if(u){for(;i<n-1;)o=e[i],r=r[o],u=u[o],i++;return o=e[i],r[o]=f,f instanceof Array?u[o]=numeric.rep(numeric.dim(f),0):u[o]=0,this}for(;i<n-1;)o=e[i],r=r[o],i++;return o=e[i],r[o]=f,this},numeric.T.prototype.getRows=function(e,t){var r=t-e+1,u,i=Array(r),o,n=this.x,f=this.y;for(u=e;u<=t;u++)i[u-e]=n[u];if(f){for(o=Array(r),u=e;u<=t;u++)o[u-e]=f[u];return new numeric.T(i,o)}return new numeric.T(i)},numeric.T.prototype.setRows=function(e,t,r){var u,i=this.x,o=this.y,n=r.x,f=r.y;for(u=e;u<=t;u++)i[u]=n[u-e];if(f)for(o||(o=numeric.rep(numeric.dim(i),0),this.y=o),u=e;u<=t;u++)o[u]=f[u-e];else if(o)for(u=e;u<=t;u++)o[u]=numeric.rep([n[u-e].length],0);return this},numeric.T.prototype.getRow=function(e){var t=this.x,r=this.y;return r?new numeric.T(t[e],r[e]):new numeric.T(t[e])},numeric.T.prototype.setRow=function(e,t){var r=this.x,u=this.y,i=t.x,o=t.y;return r[e]=i,o?(u||(u=numeric.rep(numeric.dim(r),0),this.y=u),u[e]=o):u&&(u=numeric.rep([i.length],0)),this},numeric.T.prototype.getBlock=function(e,t){var r=this.x,u=this.y,i=numeric.getBlock;return u?new numeric.T(i(r,e,t),i(u,e,t)):new numeric.T(i(r,e,t))},numeric.T.prototype.setBlock=function(e,t,r){r instanceof numeric.T||(r=new numeric.T(r));var u=this.x,i=this.y,o=numeric.setBlock,n=r.x,f=r.y;if(f)return i||(this.y=numeric.rep(numeric.dim(this),0),i=this.y),o(u,e,t,n),o(i,e,t,f),this;o(u,e,t,n),i&&o(i,e,t,numeric.rep(numeric.dim(n),0))},numeric.T.rep=function(e,t){var r=numeric.T;t instanceof r||(t=new r(t));var u=t.x,i=t.y,o=numeric.rep;return i?new r(o(e,u),o(e,i)):new r(o(e,u))},numeric.T.diag=function(e){e instanceof numeric.T||(e=new numeric.T(e));var t=e.x,r=e.y,u=numeric.diag;return r?new numeric.T(u(t),u(r)):new numeric.T(u(t))},numeric.T.eig=function(){if(this.y)throw new Error("eig: not implemented for complex matrices.");return numeric.eig(this.x)},numeric.T.identity=function(e){return new numeric.T(numeric.identity(e))},numeric.T.prototype.getDiag=function(){var e=numeric,t=this.x,r=this.y;return r?new e.T(e.getDiag(t),e.getDiag(r)):new e.T(e.getDiag(t))},numeric.house=function(e){var t=numeric.clone(e),r=e[0]>=0?1:-1,u=r*numeric.norm2(e);t[0]+=u;var i=numeric.norm2(t);if(i===0)throw new Error("eig: internal error");return numeric.div(t,i)},numeric.toUpperHessenberg=function(e){var t=numeric.dim(e);if(t.length!==2||t[0]!==t[1])throw new Error("numeric: toUpperHessenberg() only works on square matrices");var r=t[0],u,i,o,n,f,a=numeric.clone(e),m,c,v,h,s=numeric.identity(r),p;for(i=0;i<r-2;i++){for(n=Array(r-i-1),u=i+1;u<r;u++)n[u-i-1]=a[u][i];if(numeric.norm2(n)>0){for(f=numeric.house(n),m=numeric.getBlock(a,[i+1,i],[r-1,r-1]),c=numeric.tensor(f,numeric.dot(f,m)),u=i+1;u<r;u++)for(v=a[u],h=c[u-i-1],o=i;o<r;o++)v[o]-=2*h[o-i];for(m=numeric.getBlock(a,[0,i+1],[r-1,r-1]),c=numeric.tensor(numeric.dot(m,f),f),u=0;u<r;u++)for(v=a[u],h=c[u],o=i+1;o<r;o++)v[o]-=2*h[o-i-1];for(m=Array(r-i-1),u=i+1;u<r;u++)m[u-i-1]=s[u];for(c=numeric.tensor(f,numeric.dot(f,m)),u=i+1;u<r;u++)for(p=s[u],h=c[u-i-1],o=0;o<r;o++)p[o]-=2*h[o]}}return{H:a,Q:s}},numeric.epsilon=2220446049250313e-31,numeric.QRFrancis=function(x,e){typeof e=="undefined"&&(e=1e4),x=numeric.clone(x);var t=numeric.clone(x),r=numeric.dim(x),u=r[0],i,o,n,f,a,m,c,v,h,s=numeric.identity(u),p,d,B,D,A,y,b,g,j;if(u<3)return{Q:s,B:[[0,u-1]]};var l=numeric.epsilon;for(j=0;j<e;j++){for(b=0;b<u-1;b++)if(Math.abs(x[b+1][b])<l*(Math.abs(x[b][b])+Math.abs(x[b+1][b+1]))){var F=numeric.QRFrancis(numeric.getBlock(x,[0,0],[b,b]),e),E=numeric.QRFrancis(numeric.getBlock(x,[b+1,b+1],[u-1,u-1]),e);for(B=Array(b+1),y=0;y<=b;y++)B[y]=s[y];for(D=numeric.dot(F.Q,B),y=0;y<=b;y++)s[y]=D[y];for(B=Array(u-b-1),y=b+1;y<u;y++)B[y-b-1]=s[y];for(D=numeric.dot(E.Q,B),y=b+1;y<u;y++)s[y]=D[y-b-1];return{Q:s,B:F.B.concat(numeric.add(E.B,b+1))}}if(n=x[u-2][u-2],f=x[u-2][u-1],a=x[u-1][u-2],m=x[u-1][u-1],v=n+m,c=n*m-f*a,h=numeric.getBlock(x,[0,0],[2,2]),v*v>=4*c){var M,_;M=.5*(v+Math.sqrt(v*v-4*c)),_=.5*(v-Math.sqrt(v*v-4*c)),h=numeric.add(numeric.sub(numeric.dot(h,h),numeric.mul(h,M+_)),numeric.diag(numeric.rep([3],M*_)))}else h=numeric.add(numeric.sub(numeric.dot(h,h),numeric.mul(h,v)),numeric.diag(numeric.rep([3],c)));for(i=[h[0][0],h[1][0],h[2][0]],o=numeric.house(i),B=[x[0],x[1],x[2]],D=numeric.tensor(o,numeric.dot(o,B)),y=0;y<3;y++)for(d=x[y],A=D[y],g=0;g<u;g++)d[g]-=2*A[g];for(B=numeric.getBlock(x,[0,0],[u-1,2]),D=numeric.tensor(numeric.dot(B,o),o),y=0;y<u;y++)for(d=x[y],A=D[y],g=0;g<3;g++)d[g]-=2*A[g];for(B=[s[0],s[1],s[2]],D=numeric.tensor(o,numeric.dot(o,B)),y=0;y<3;y++)for(p=s[y],A=D[y],g=0;g<u;g++)p[g]-=2*A[g];var w;for(b=0;b<u-2;b++){for(g=b;g<=b+1;g++)if(Math.abs(x[g+1][g])<l*(Math.abs(x[g][g])+Math.abs(x[g+1][g+1]))){var F=numeric.QRFrancis(numeric.getBlock(x,[0,0],[g,g]),e),E=numeric.QRFrancis(numeric.getBlock(x,[g+1,g+1],[u-1,u-1]),e);for(B=Array(g+1),y=0;y<=g;y++)B[y]=s[y];for(D=numeric.dot(F.Q,B),y=0;y<=g;y++)s[y]=D[y];for(B=Array(u-g-1),y=g+1;y<u;y++)B[y-g-1]=s[y];for(D=numeric.dot(E.Q,B),y=g+1;y<u;y++)s[y]=D[y-g-1];return{Q:s,B:F.B.concat(numeric.add(E.B,g+1))}}for(w=Math.min(u-1,b+3),i=Array(w-b),y=b+1;y<=w;y++)i[y-b-1]=x[y][b];for(o=numeric.house(i),B=numeric.getBlock(x,[b+1,b],[w,u-1]),D=numeric.tensor(o,numeric.dot(o,B)),y=b+1;y<=w;y++)for(d=x[y],A=D[y-b-1],g=b;g<u;g++)d[g]-=2*A[g-b];for(B=numeric.getBlock(x,[0,b+1],[u-1,w]),D=numeric.tensor(numeric.dot(B,o),o),y=0;y<u;y++)for(d=x[y],A=D[y],g=b+1;g<=w;g++)d[g]-=2*A[g-b-1];for(B=Array(w-b),y=b+1;y<=w;y++)B[y-b-1]=s[y];for(D=numeric.tensor(o,numeric.dot(o,B)),y=b+1;y<=w;y++)for(p=s[y],A=D[y-b-1],g=0;g<u;g++)p[g]-=2*A[g]}}throw new Error("numeric: eigenvalue iteration does not converge -- increase maxiter?")},numeric.eig=function(e,t){var r=numeric.toUpperHessenberg(e),u=numeric.QRFrancis(r.H,t),i=numeric.T,o=e.length,n,f,a=u.B,m=numeric.dot(u.Q,numeric.dot(r.H,numeric.transpose(u.Q))),c=new i(numeric.dot(u.Q,r.Q)),v,h=a.length,s,p,d,B,D,A,y,b,g,j,l,F,E,M,_=Math.sqrt;for(f=0;f<h;f++)if(n=a[f][0],n!==a[f][1]){if(s=n+1,p=m[n][n],d=m[n][s],B=m[s][n],D=m[s][s],d===0&&B===0)continue;A=-p-D,y=p*D-d*B,b=A*A-4*y,b>=0?(A<0?g=-.5*(A-_(b)):g=-.5*(A+_(b)),E=(p-g)*(p-g)+d*d,M=B*B+(D-g)*(D-g),E>M?(E=_(E),l=(p-g)/E,F=d/E):(M=_(M),l=B/M,F=(D-g)/M),v=new i([[F,-l],[l,F]]),c.setRows(n,s,v.dot(c.getRows(n,s)))):(g=-.5*A,j=.5*_(-b),E=(p-g)*(p-g)+d*d,M=B*B+(D-g)*(D-g),E>M?(E=_(E+j*j),l=(p-g)/E,F=d/E,g=0,j/=E):(M=_(M+j*j),l=B/M,F=(D-g)/M,g=j/M,j=0),v=new i([[F,-l],[l,F]],[[g,j],[j,-g]]),c.setRows(n,s,v.dot(c.getRows(n,s))))}var w=c.dot(e).dot(c.transjugate()),o=e.length,C=numeric.T.identity(o);for(s=0;s<o;s++)if(s>0)for(f=s-1;f>=0;f--){var P=w.get([f,f]),S=w.get([s,s]);if(numeric.neq(P.x,S.x)||numeric.neq(P.y,S.y))g=w.getRow(f).getBlock([f],[s-1]),j=C.getRow(s).getBlock([f],[s-1]),C.set([s,f],w.get([f,s]).neg().sub(g.dot(j)).div(P.sub(S)));else{C.setRow(s,C.getRow(f));continue}}for(s=0;s<o;s++)g=C.getRow(s),C.setRow(s,g.div(g.norm2()));return C=C.transpose(),C=c.transjugate().dot(C),{lambda:w.getDiag(),E:C}},numeric.ccsSparse=function(e){var t=e.length,r,u,i,o,n=[];for(i=t-1;i!==-1;--i){u=e[i];for(o in u){for(o=parseInt(o);o>=n.length;)n[n.length]=0;u[o]!==0&&n[o]++}}var r=n.length,f=Array(r+1);for(f[0]=0,i=0;i<r;++i)f[i+1]=f[i]+n[i];var a=Array(f[r]),m=Array(f[r]);for(i=t-1;i!==-1;--i){u=e[i];for(o in u)u[o]!==0&&(n[o]--,a[f[o]+n[o]]=i,m[f[o]+n[o]]=u[o])}return[f,a,m]},numeric.ccsFull=function(e){var t=e[0],r=e[1],u=e[2],i=numeric.ccsDim(e),o=i[0],n=i[1],f,a,m,c,v=numeric.rep([o,n],0);for(f=0;f<n;f++)for(m=t[f],c=t[f+1],a=m;a<c;++a)v[r[a]][f]=u[a];return v},numeric.ccsTSolve=function(e,t,r,u,i){var o=e[0],n=e[1],f=e[2],a=o.length-1,m=Math.max,c=0;typeof u=="undefined"&&(r=numeric.rep([a],0)),typeof u=="undefined"&&(u=numeric.linspace(0,r.length-1)),typeof i=="undefined"&&(i=[]);function v(y){var b;if(r[y]===0){for(r[y]=1,b=o[y];b<o[y+1];++b)v(n[b]);i[c]=y,++c}}var h,s,p,d,B,D,A;for(h=u.length-1;h!==-1;--h)v(u[h]);for(i.length=c,h=i.length-1;h!==-1;--h)r[i[h]]=0;for(h=u.length-1;h!==-1;--h)s=u[h],r[s]=t[s];for(h=i.length-1;h!==-1;--h){for(s=i[h],p=o[s],d=m(o[s+1],p),B=p;B!==d;++B)if(n[B]===s){r[s]/=f[B];break}for(A=r[s],B=p;B!==d;++B)D=n[B],D!==s&&(r[D]-=A*f[B])}return r},numeric.ccsDFS=function(e){this.k=Array(e),this.k1=Array(e),this.j=Array(e)},numeric.ccsDFS.prototype.dfs=function(e,t,r,u,i,o){var n=0,f,a=i.length,m=this.k,c=this.k1,v=this.j,h,s;if(u[e]===0)for(u[e]=1,v[0]=e,m[0]=h=t[e],c[0]=s=t[e+1];;)if(h>=s){if(i[a]=v[n],n===0)return;++a,--n,h=m[n],s=c[n]}else f=o[r[h]],u[f]===0?(u[f]=1,m[n]=h,++n,v[n]=f,h=t[f],c[n]=s=t[f+1]):++h},numeric.ccsLPSolve=function(e,t,r,u,i,o,n){var f=e[0],a=e[1],m=e[2],c=f.length-1,v=t[0],h=t[1],s=t[2],p,d,B,D,A,y,b,g,j;for(d=v[i],B=v[i+1],u.length=0,p=d;p<B;++p)n.dfs(o[h[p]],f,a,r,u,o);for(p=u.length-1;p!==-1;--p)r[u[p]]=0;for(p=d;p!==B;++p)D=o[h[p]],r[D]=s[p];for(p=u.length-1;p!==-1;--p){for(D=u[p],A=f[D],y=f[D+1],b=A;b<y;++b)if(o[a[b]]===D){r[D]/=m[b];break}for(j=r[D],b=A;b<y;++b)g=o[a[b]],g!==D&&(r[g]-=j*m[b])}return r},numeric.ccsLUP1=function(e,t){var r=e[0].length-1,u=[numeric.rep([r+1],0),[],[]],i=[numeric.rep([r+1],0),[],[]],o=u[0],n=u[1],f=u[2],a=i[0],m=i[1],c=i[2],v=numeric.rep([r],0),h=numeric.rep([r],0),s,p,d,B,D,A,y,b=numeric.ccsLPSolve,g=Math.abs,j=numeric.linspace(0,r-1),l=numeric.linspace(0,r-1),F=new numeric.ccsDFS(r);for(typeof t=="undefined"&&(t=1),s=0;s<r;++s){for(b(u,e,v,h,s,l,F),B=-1,D=-1,p=h.length-1;p!==-1;--p)d=h[p],!(d<=s)&&(A=g(v[d]),A>B&&(D=d,B=A));for(g(v[s])<t*B&&(p=j[s],B=j[D],j[s]=B,l[B]=s,j[D]=p,l[p]=D,B=v[s],v[s]=v[D],v[D]=B),B=o[s],D=a[s],y=v[s],n[B]=j[s],f[B]=1,++B,p=h.length-1;p!==-1;--p)d=h[p],A=v[d],h[p]=0,v[d]=0,d<=s?(m[D]=d,c[D]=A,++D):(n[B]=j[d],f[B]=A/y,++B);o[s+1]=B,a[s+1]=D}for(p=n.length-1;p!==-1;--p)n[p]=l[n[p]];return{L:u,U:i,P:j,Pinv:l}},numeric.ccsDFS0=function(e){this.k=Array(e),this.k1=Array(e),this.j=Array(e)},numeric.ccsDFS0.prototype.dfs=function(e,t,r,u,i,o,n){var f=0,a,m=i.length,c=this.k,v=this.k1,h=this.j,s,p;if(u[e]===0)for(u[e]=1,h[0]=e,c[0]=s=t[o[e]],v[0]=p=t[o[e]+1];;){if(isNaN(s))throw new Error("Ow!");if(s>=p){if(i[m]=o[h[f]],f===0)return;++m,--f,s=c[f],p=v[f]}else a=r[s],u[a]===0?(u[a]=1,c[f]=s,++f,h[f]=a,a=o[a],s=t[a],v[f]=p=t[a+1]):++s}},numeric.ccsLPSolve0=function(e,t,r,u,i,o,n,f){var a=e[0],m=e[1],c=e[2],v=a.length-1,h=t[0],s=t[1],p=t[2],d,B,D,A,y,b,g,j,l;for(B=h[i],D=h[i+1],u.length=0,d=B;d<D;++d)f.dfs(s[d],a,m,r,u,o,n);for(d=u.length-1;d!==-1;--d)A=u[d],r[n[A]]=0;for(d=B;d!==D;++d)A=s[d],r[A]=p[d];for(d=u.length-1;d!==-1;--d){for(A=u[d],j=n[A],y=a[A],b=a[A+1],g=y;g<b;++g)if(m[g]===j){r[j]/=c[g];break}for(l=r[j],g=y;g<b;++g)r[m[g]]-=l*c[g];r[j]=l}},numeric.ccsLUP0=function(e,t){var r=e[0].length-1,u=[numeric.rep([r+1],0),[],[]],i=[numeric.rep([r+1],0),[],[]],o=u[0],n=u[1],f=u[2],a=i[0],m=i[1],c=i[2],v=numeric.rep([r],0),h=numeric.rep([r],0),s,p,d,B,D,A,y,b=numeric.ccsLPSolve0,g=Math.abs,j=numeric.linspace(0,r-1),l=numeric.linspace(0,r-1),F=new numeric.ccsDFS0(r);for(typeof t=="undefined"&&(t=1),s=0;s<r;++s){for(b(u,e,v,h,s,l,j,F),B=-1,D=-1,p=h.length-1;p!==-1;--p)d=h[p],!(d<=s)&&(A=g(v[j[d]]),A>B&&(D=d,B=A));for(g(v[j[s]])<t*B&&(p=j[s],B=j[D],j[s]=B,l[B]=s,j[D]=p,l[p]=D),B=o[s],D=a[s],y=v[j[s]],n[B]=j[s],f[B]=1,++B,p=h.length-1;p!==-1;--p)d=h[p],A=v[j[d]],h[p]=0,v[j[d]]=0,d<=s?(m[D]=d,c[D]=A,++D):(n[B]=j[d],f[B]=A/y,++B);o[s+1]=B,a[s+1]=D}for(p=n.length-1;p!==-1;--p)n[p]=l[n[p]];return{L:u,U:i,P:j,Pinv:l}},numeric.ccsLUP=numeric.ccsLUP0,numeric.ccsDim=function(e){return[numeric.sup(e[1])+1,e[0].length-1]},numeric.ccsGetBlock=function(e,t,r){var u=numeric.ccsDim(e),i=u[0],o=u[1];typeof t=="undefined"?t=numeric.linspace(0,i-1):typeof t=="number"&&(t=[t]),typeof r=="undefined"?r=numeric.linspace(0,o-1):typeof r=="number"&&(r=[r]);var n,f=t.length,a,m=r.length,c,v,h,s=numeric.rep([o],0),p=[],d=[],B=[s,p,d],D=e[0],A=e[1],y=e[2],b=numeric.rep([i],0),g=0,j=numeric.rep([i],0);for(a=0;a<m;++a){v=r[a];var l=D[v],F=D[v+1];for(n=l;n<F;++n)c=A[n],j[c]=1,b[c]=y[n];for(n=0;n<f;++n)h=t[n],j[h]&&(p[g]=n,d[g]=b[t[n]],++g);for(n=l;n<F;++n)c=A[n],j[c]=0;s[a+1]=g}return B},numeric.ccsDot=function(e,t){var r=e[0],u=e[1],i=e[2],o=t[0],n=t[1],f=t[2],a=numeric.ccsDim(e),m=numeric.ccsDim(t),c=a[0],v=a[1],h=m[1],s=numeric.rep([c],0),p=numeric.rep([c],0),d=Array(c),B=numeric.rep([h],0),D=[],A=[],y=[B,D,A],b,g,j,l,F,E,M,_,w,C,P;for(j=0;j!==h;++j){for(l=o[j],F=o[j+1],w=0,g=l;g<F;++g)for(C=n[g],P=f[g],E=r[C],M=r[C+1],b=E;b<M;++b)_=u[b],p[_]===0&&(d[w]=_,p[_]=1,w=w+1),s[_]=s[_]+i[b]*P;for(l=B[j],F=l+w,B[j+1]=F,g=w-1;g!==-1;--g)P=l+g,b=d[g],D[P]=b,A[P]=s[b],p[b]=0,s[b]=0;B[j+1]=B[j]+w}return y},numeric.ccsLUPSolve=function(e,t){var r=e.L,u=e.U,i=e.P,o=t[0],n=!1;typeof o!="object"&&(t=[[0,t.length],numeric.linspace(0,t.length-1),t],o=t[0],n=!0);var f=t[1],a=t[2],m=r[0].length-1,c=o.length-1,v=numeric.rep([m],0),h=Array(m),s=numeric.rep([m],0),p=Array(m),d=numeric.rep([c+1],0),B=[],D=[],A=numeric.ccsTSolve,y,b,g,j,l,F,E=0;for(y=0;y<c;++y){for(l=0,g=o[y],j=o[y+1],b=g;b<j;++b)F=e.Pinv[f[b]],p[l]=F,s[F]=a[b],++l;for(p.length=l,A(r,s,v,p,h),b=p.length-1;b!==-1;--b)s[p[b]]=0;if(A(u,v,s,h,p),n)return s;for(b=h.length-1;b!==-1;--b)v[h[b]]=0;for(b=p.length-1;b!==-1;--b)F=p[b],B[E]=F,D[E]=s[F],s[F]=0,++E;d[y+1]=E}return[d,B,D]},numeric.ccsbinop=function(e,t){return typeof t=="undefined"&&(t=""),Function("X","Y",`var Xi = X[0], Xj = X[1], Xv = X[2];
var Yi = Y[0], Yj = Y[1], Yv = Y[2];
var n = Xi.length-1,m = Math.max(numeric.sup(Xj),numeric.sup(Yj))+1;
var Zi = numeric.rep([n+1],0), Zj = [], Zv = [];
var x = numeric.rep([m],0),y = numeric.rep([m],0);
var xk,yk,zk;
var i,j,j0,j1,k,p=0;
`+t+`for(i=0;i<n;++i) {
  j0 = Xi[i]; j1 = Xi[i+1];
  for(j=j0;j!==j1;++j) {
    k = Xj[j];
    x[k] = 1;
    Zj[p] = k;
    ++p;
  }
  j0 = Yi[i]; j1 = Yi[i+1];
  for(j=j0;j!==j1;++j) {
    k = Yj[j];
    y[k] = Yv[j];
    if(x[k] === 0) {
      Zj[p] = k;
      ++p;
    }
  }
  Zi[i+1] = p;
  j0 = Xi[i]; j1 = Xi[i+1];
  for(j=j0;j!==j1;++j) x[Xj[j]] = Xv[j];
  j0 = Zi[i]; j1 = Zi[i+1];
  for(j=j0;j!==j1;++j) {
    k = Zj[j];
    xk = x[k];
    yk = y[k];
`+e+`
    Zv[j] = zk;
  }
  j0 = Xi[i]; j1 = Xi[i+1];
  for(j=j0;j!==j1;++j) x[Xj[j]] = 0;
  j0 = Yi[i]; j1 = Yi[i+1];
  for(j=j0;j!==j1;++j) y[Yj[j]] = 0;
}
return [Zi,Zj,Zv];`)},function(){var k,A,B,C;for(k in numeric.ops2)isFinite(eval("1"+numeric.ops2[k]+"0"))?A="[Y[0],Y[1],numeric."+k+"(X,Y[2])]":A="NaN",isFinite(eval("0"+numeric.ops2[k]+"1"))?B="[X[0],X[1],numeric."+k+"(X[2],Y)]":B="NaN",isFinite(eval("1"+numeric.ops2[k]+"0"))&&isFinite(eval("0"+numeric.ops2[k]+"1"))?C="numeric.ccs"+k+"MM(X,Y)":C="NaN",numeric["ccs"+k+"MM"]=numeric.ccsbinop("zk = xk "+numeric.ops2[k]+"yk;"),numeric["ccs"+k]=Function("X","Y",'if(typeof X === "number") return '+A+`;
if(typeof Y === "number") return `+B+`;
return `+C+`;
`)}(),numeric.ccsScatter=function(e){var t=e[0],r=e[1],u=e[2],i=numeric.sup(r)+1,o=t.length,n=numeric.rep([i],0),f=Array(o),a=Array(o),m=numeric.rep([i],0),c;for(c=0;c<o;++c)m[r[c]]++;for(c=0;c<i;++c)n[c+1]=n[c]+m[c];var v=n.slice(0),h,s;for(c=0;c<o;++c)s=r[c],h=v[s],f[h]=t[c],a[h]=u[c],v[s]=v[s]+1;return[n,f,a]},numeric.ccsGather=function(e){var t=e[0],r=e[1],u=e[2],i=t.length-1,o=r.length,n=Array(o),f=Array(o),a=Array(o),m,c,v,h,s;for(s=0,m=0;m<i;++m)for(v=t[m],h=t[m+1],c=v;c!==h;++c)f[s]=m,n[s]=r[c],a[s]=u[c],++s;return[n,f,a]},numeric.sdim=function x(e,t,r){if(typeof t=="undefined"&&(t=[]),typeof e!="object")return t;typeof r=="undefined"&&(r=0),r in t||(t[r]=0),e.length>t[r]&&(t[r]=e.length);var u;for(u in e)e.hasOwnProperty(u)&&x(e[u],t,r+1);return t},numeric.sclone=function x(e,t,r){typeof t=="undefined"&&(t=0),typeof r=="undefined"&&(r=numeric.sdim(e).length);var u,i=Array(e.length);if(t===r-1){for(u in e)e.hasOwnProperty(u)&&(i[u]=e[u]);return i}for(u in e)e.hasOwnProperty(u)&&(i[u]=x(e[u],t+1,r));return i},numeric.sdiag=function(e){var t=e.length,r,u=Array(t),i;for(r=t-1;r>=1;r-=2)i=r-1,u[r]=[],u[r][r]=e[r],u[i]=[],u[i][i]=e[i];return r===0&&(u[0]=[],u[0][0]=e[r]),u},numeric.sidentity=function(e){return numeric.sdiag(numeric.rep([e],1))},numeric.stranspose=function(e){var t=[],r=e.length,u,i,o;for(u in e)if(!!e.hasOwnProperty(u)){o=e[u];for(i in o)!o.hasOwnProperty(i)||(typeof t[i]!="object"&&(t[i]=[]),t[i][u]=o[i])}return t},numeric.sLUP=function(e,t){throw new Error("The function numeric.sLUP had a bug in it and has been removed. Please use the new numeric.ccsLUP function instead.")},numeric.sdotMM=function(e,t){var r=e.length,u=t.length,i=numeric.stranspose(t),o=i.length,n,f,a,m,c,v,h=Array(r),s;for(a=r-1;a>=0;a--){for(s=[],n=e[a],c=o-1;c>=0;c--){v=0,f=i[c];for(m in n)!n.hasOwnProperty(m)||m in f&&(v+=n[m]*f[m]);v&&(s[c]=v)}h[a]=s}return h},numeric.sdotMV=function(e,t){var r=e.length,u,i,o,n=Array(r),f;for(i=r-1;i>=0;i--){u=e[i],f=0;for(o in u)!u.hasOwnProperty(o)||t[o]&&(f+=u[o]*t[o]);f&&(n[i]=f)}return n},numeric.sdotVM=function(e,t){var r,u,i,o,n=[];for(r in e)if(!!e.hasOwnProperty(r)){i=t[r],o=e[r];for(u in i)!i.hasOwnProperty(u)||(n[u]||(n[u]=0),n[u]+=o*i[u])}return n},numeric.sdotVV=function(e,t){var r,u=0;for(r in e)e[r]&&t[r]&&(u+=e[r]*t[r]);return u},numeric.sdot=function(e,t){var r=numeric.sdim(e).length,u=numeric.sdim(t).length,i=r*1e3+u;switch(i){case 0:return e*t;case 1001:return numeric.sdotVV(e,t);case 2001:return numeric.sdotMV(e,t);case 1002:return numeric.sdotVM(e,t);case 2002:return numeric.sdotMM(e,t);default:throw new Error("numeric.sdot not implemented for tensors of order "+r+" and "+u)}},numeric.sscatter=function(e){var t=e[0].length,r,u,i,o=e.length,n=[],f;for(u=t-1;u>=0;--u)if(!!e[o-1][u]){for(f=n,i=0;i<o-2;i++)r=e[i][u],f[r]||(f[r]=[]),f=f[r];f[e[i][u]]=e[i+1][u]}return n},numeric.sgather=function x(e,t,r){typeof t=="undefined"&&(t=[]),typeof r=="undefined"&&(r=[]);var u,i,o;u=r.length;for(i in e)if(e.hasOwnProperty(i))if(r[u]=parseInt(i),o=e[i],typeof o=="number"){if(o){if(t.length===0)for(i=u+1;i>=0;--i)t[i]=[];for(i=u;i>=0;--i)t[i].push(r[i]);t[u+1].push(o)}}else x(o,t,r);return r.length>u&&r.pop(),t},numeric.cLU=function(e){var t=e[0],r=e[1],u=e[2],i=t.length,o=0,n,f,a,m,c,v;for(n=0;n<i;n++)t[n]>o&&(o=t[n]);o++;var h=Array(o),s=Array(o),p=numeric.rep([o],Infinity),d=numeric.rep([o],-Infinity),B,D,A;for(a=0;a<i;a++)n=t[a],f=r[a],f<p[n]&&(p[n]=f),f>d[n]&&(d[n]=f);for(n=0;n<o-1;n++)d[n]>d[n+1]&&(d[n+1]=d[n]);for(n=o-1;n>=1;n--)p[n]<p[n-1]&&(p[n-1]=p[n]);var y=0,b=0;for(n=0;n<o;n++)s[n]=numeric.rep([d[n]-p[n]+1],0),h[n]=numeric.rep([n-p[n]],0),y+=n-p[n]+1,b+=d[n]-n+1;for(a=0;a<i;a++)n=t[a],s[n][r[a]-p[n]]=u[a];for(n=0;n<o-1;n++)for(m=n-p[n],B=s[n],f=n+1;p[f]<=n&&f<o;f++)if(c=n-p[f],v=d[n]-n,D=s[f],A=D[c]/B[m],A){for(a=1;a<=v;a++)D[a+c]-=A*B[a+m];h[f][n-p[f]]=A}var B=[],D=[],g=[],j=[],l=[],F=[],i,E,M;for(i=0,E=0,n=0;n<o;n++){for(m=p[n],c=d[n],M=s[n],f=n;f<=c;f++)M[f-m]&&(B[i]=n,D[i]=f,g[i]=M[f-m],i++);for(M=h[n],f=m;f<n;f++)M[f-m]&&(j[E]=n,l[E]=f,F[E]=M[f-m],E++);j[E]=n,l[E]=n,F[E]=1,E++}return{U:[B,D,g],L:[j,l,F]}},numeric.cLUsolve=function(e,t){var r=e.L,u=e.U,i=numeric.clone(t),o=r[0],n=r[1],f=r[2],a=u[0],m=u[1],c=u[2],v=a.length,h=o.length,s=i.length,p,d;for(d=0,p=0;p<s;p++){for(;n[d]<p;)i[p]-=f[d]*i[n[d]],d++;d++}for(d=v-1,p=s-1;p>=0;p--){for(;m[d]>p;)i[p]-=c[d]*i[m[d]],d--;i[p]/=c[d],d--}return i},numeric.cgrid=function(e,t){typeof e=="number"&&(e=[e,e]);var r=numeric.rep(e,-1),u,i,o;if(typeof t!="function")switch(t){case"L":t=function(n,f){return n>=e[0]/2||f<e[1]/2};break;default:t=function(n,f){return!0};break}for(o=0,u=1;u<e[0]-1;u++)for(i=1;i<e[1]-1;i++)t(u,i)&&(r[u][i]=o,o++);return r},numeric.cdelsq=function(e){var t=[[-1,0],[0,-1],[0,1],[1,0]],r=numeric.dim(e),u=r[0],i=r[1],o,n,f,a,m,c=[],v=[],h=[];for(o=1;o<u-1;o++)for(n=1;n<i-1;n++)if(!(e[o][n]<0)){for(f=0;f<4;f++)a=o+t[f][0],m=n+t[f][1],!(e[a][m]<0)&&(c.push(e[o][n]),v.push(e[a][m]),h.push(-1));c.push(e[o][n]),v.push(e[o][n]),h.push(4)}return[c,v,h]},numeric.cdotMV=function(e,t){var r,u=e[0],i=e[1],o=e[2],n,f=u.length,a;for(a=0,n=0;n<f;n++)u[n]>a&&(a=u[n]);for(a++,r=numeric.rep([a],0),n=0;n<f;n++)r[u[n]]+=o[n]*t[i[n]];return r},numeric.Spline=function(e,t,r,u,i){this.x=e,this.yl=t,this.yr=r,this.kl=u,this.kr=i},numeric.Spline.prototype._at=function(e,t){var r=this.x,u=this.yl,i=this.yr,o=this.kl,n=this.kr,e,f,a,m,c=numeric.add,v=numeric.sub,h=numeric.mul;f=v(h(o[t],r[t+1]-r[t]),v(i[t+1],u[t])),a=c(h(n[t+1],r[t]-r[t+1]),v(i[t+1],u[t])),m=(e-r[t])/(r[t+1]-r[t]);var s=m*(1-m);return c(c(c(h(1-m,u[t]),h(m,i[t+1])),h(f,s*(1-m))),h(a,s*m))},numeric.Spline.prototype.at=function(e){if(typeof e=="number"){var t=this.x,n=t.length,r,u,i,o=Math.floor;for(r=0,u=n-1;u-r>1;)i=o((r+u)/2),t[i]<=e?r=i:u=i;return this._at(e,r)}var n=e.length,f,a=Array(n);for(f=n-1;f!==-1;--f)a[f]=this.at(e[f]);return a},numeric.Spline.prototype.diff=function(){var e=this.x,t=this.yl,r=this.yr,u=this.kl,i=this.kr,o=t.length,n,f,a,m=u,c=i,v=Array(o),h=Array(o),s=numeric.add,p=numeric.mul,d=numeric.div,B=numeric.sub;for(n=o-1;n!==-1;--n)f=e[n+1]-e[n],a=B(r[n+1],t[n]),v[n]=d(s(p(a,6),p(u[n],-4*f),p(i[n+1],-2*f)),f*f),h[n+1]=d(s(p(a,-6),p(u[n],2*f),p(i[n+1],4*f)),f*f);return new numeric.Spline(e,m,c,v,h)},numeric.Spline.prototype.roots=function(){function e(N){return N*N}var t=[],r=this.x,u=this.yl,i=this.yr,o=this.kl,n=this.kr;typeof u[0]=="number"&&(u=[u],i=[i],o=[o],n=[n]);var f=u.length,a=r.length-1,m,c,v,h,s,p,d,t=Array(f),B,D,A,y,b,g,j,l,F,E,M,_,w,C,P,S,k=Math.sqrt;for(m=0;m!==f;++m){for(h=u[m],s=i[m],p=o[m],d=n[m],B=[],c=0;c!==a;c++){for(c>0&&s[c]*h[c]<0&&B.push(r[c]),F=r[c+1]-r[c],r[c],y=h[c],b=s[c+1],D=p[c]/F,A=d[c+1]/F,l=e(D-A+3*(y-b))+12*A*y,g=A+3*y+2*D-3*b,j=3*(A+D+2*(y-b)),l<=0?(M=g/j,M>r[c]&&M<r[c+1]?E=[r[c],M,r[c+1]]:E=[r[c],r[c+1]]):(M=(g-k(l))/j,_=(g+k(l))/j,E=[r[c]],M>r[c]&&M<r[c+1]&&E.push(M),_>r[c]&&_<r[c+1]&&E.push(_),E.push(r[c+1])),C=E[0],M=this._at(C,c),v=0;v<E.length-1;v++){if(P=E[v+1],_=this._at(P,c),M===0){B.push(C),C=P,M=_;continue}if(_===0||M*_>0){C=P,M=_;continue}for(var U=0;S=(M*P-_*C)/(M-_),!(S<=C||S>=P);)if(w=this._at(S,c),w*_>0)P=S,_=w,U===-1&&(M*=.5),U=-1;else if(w*M>0)C=S,M=w,U===1&&(_*=.5),U=1;else break;B.push(S),C=E[v+1],M=this._at(C,c)}_===0&&B.push(P)}t[m]=B}return typeof this.yl[0]=="number"?t[0]:t},numeric.spline=function(e,t,r,u){var i=e.length,o=[],n=[],f=[],a,m=numeric.sub,c=numeric.mul,v=numeric.add;for(a=i-2;a>=0;a--)n[a]=e[a+1]-e[a],f[a]=m(t[a+1],t[a]);(typeof r=="string"||typeof u=="string")&&(r=u="periodic");var h=[[],[],[]];switch(typeof r){case"undefined":o[0]=c(3/(n[0]*n[0]),f[0]),h[0].push(0,0),h[1].push(0,1),h[2].push(2/n[0],1/n[0]);break;case"string":o[0]=v(c(3/(n[i-2]*n[i-2]),f[i-2]),c(3/(n[0]*n[0]),f[0])),h[0].push(0,0,0),h[1].push(i-2,0,1),h[2].push(1/n[i-2],2/n[i-2]+2/n[0],1/n[0]);break;default:o[0]=r,h[0].push(0),h[1].push(0),h[2].push(1);break}for(a=1;a<i-1;a++)o[a]=v(c(3/(n[a-1]*n[a-1]),f[a-1]),c(3/(n[a]*n[a]),f[a])),h[0].push(a,a,a),h[1].push(a-1,a,a+1),h[2].push(1/n[a-1],2/n[a-1]+2/n[a],1/n[a]);switch(typeof u){case"undefined":o[i-1]=c(3/(n[i-2]*n[i-2]),f[i-2]),h[0].push(i-1,i-1),h[1].push(i-2,i-1),h[2].push(1/n[i-2],2/n[i-2]);break;case"string":h[1][h[1].length-1]=0;break;default:o[i-1]=u,h[0].push(i-1),h[1].push(i-1),h[2].push(1);break}typeof o[0]!="number"?o=numeric.transpose(o):o=[o];var s=Array(o.length);if(typeof r=="string")for(a=s.length-1;a!==-1;--a)s[a]=numeric.ccsLUPSolve(numeric.ccsLUP(numeric.ccsScatter(h)),o[a]),s[a][i-1]=s[a][0];else for(a=s.length-1;a!==-1;--a)s[a]=numeric.cLUsolve(numeric.cLU(h),o[a]);return typeof t[0]=="number"?s=s[0]:s=numeric.transpose(s),new numeric.Spline(e,t,t,s,s)},numeric.fftpow2=function x(e,t){var r=e.length;if(r!==1){var u=Math.cos,i=Math.sin,o,n,f=Array(r/2),a=Array(r/2),m=Array(r/2),c=Array(r/2);for(n=r/2,o=r-1;o!==-1;--o)--n,m[n]=e[o],c[n]=t[o],--o,f[n]=e[o],a[n]=t[o];x(f,a),x(m,c),n=r/2;var v,h=-6.283185307179586/r,s,p;for(o=r-1;o!==-1;--o)--n,n===-1&&(n=r/2-1),v=h*o,s=u(v),p=i(v),e[o]=f[n]+s*m[n]-p*c[n],t[o]=a[n]+s*c[n]+p*m[n]}},numeric._ifftpow2=function x(e,t){var r=e.length;if(r!==1){var u=Math.cos,i=Math.sin,o,n,f=Array(r/2),a=Array(r/2),m=Array(r/2),c=Array(r/2);for(n=r/2,o=r-1;o!==-1;--o)--n,m[n]=e[o],c[n]=t[o],--o,f[n]=e[o],a[n]=t[o];x(f,a),x(m,c),n=r/2;var v,h=6.283185307179586/r,s,p;for(o=r-1;o!==-1;--o)--n,n===-1&&(n=r/2-1),v=h*o,s=u(v),p=i(v),e[o]=f[n]+s*m[n]-p*c[n],t[o]=a[n]+s*c[n]+p*m[n]}},numeric.ifftpow2=function(e,t){numeric._ifftpow2(e,t),numeric.diveq(e,e.length),numeric.diveq(t,t.length)},numeric.convpow2=function(e,t,r,u){numeric.fftpow2(e,t),numeric.fftpow2(r,u);var i,o=e.length,n,f,a,m;for(i=o-1;i!==-1;--i)n=e[i],a=t[i],f=r[i],m=u[i],e[i]=n*f-a*m,t[i]=n*m+a*f;numeric.ifftpow2(e,t)},numeric.T.prototype.fft=function(){var e=this.x,t=this.y,r=e.length,u=Math.log,i=u(2),o=Math.ceil(u(2*r-1)/i),n=Math.pow(2,o),f=numeric.rep([n],0),a=numeric.rep([n],0),m=Math.cos,c=Math.sin,v,h=-3.141592653589793/r,s,p=numeric.rep([n],0),d=numeric.rep([n],0);for(v=0;v<r;v++)p[v]=e[v];if(typeof t!="undefined")for(v=0;v<r;v++)d[v]=t[v];for(f[0]=1,v=1;v<=n/2;v++)s=h*v*v,f[v]=m(s),a[v]=c(s),f[n-v]=m(s),a[n-v]=c(s);var B=new numeric.T(p,d),D=new numeric.T(f,a);return B=B.mul(D),numeric.convpow2(B.x,B.y,numeric.clone(D.x),numeric.neg(D.y)),B=B.mul(D),B.x.length=r,B.y.length=r,B},numeric.T.prototype.ifft=function(){var e=this.x,t=this.y,r=e.length,u=Math.log,i=u(2),o=Math.ceil(u(2*r-1)/i),n=Math.pow(2,o),f=numeric.rep([n],0),a=numeric.rep([n],0),m=Math.cos,c=Math.sin,v,h=3.141592653589793/r,s,p=numeric.rep([n],0),d=numeric.rep([n],0);for(v=0;v<r;v++)p[v]=e[v];if(typeof t!="undefined")for(v=0;v<r;v++)d[v]=t[v];for(f[0]=1,v=1;v<=n/2;v++)s=h*v*v,f[v]=m(s),a[v]=c(s),f[n-v]=m(s),a[n-v]=c(s);var B=new numeric.T(p,d),D=new numeric.T(f,a);return B=B.mul(D),numeric.convpow2(B.x,B.y,numeric.clone(D.x),numeric.neg(D.y)),B=B.mul(D),B.x.length=r,B.y.length=r,B.div(r)},numeric.gradient=function(e,t){var r=t.length,u=e(t);if(isNaN(u))throw new Error("gradient: f(x) is a NaN!");var i=Math.max,o,n=numeric.clone(t),f,a,m=Array(r),c=numeric.div,v=numeric.sub,h,i=Math.max,s=.001,p=Math.abs,d=Math.min,B,D,A,y=0,b,g,j;for(o=0;o<r;o++)for(var l=i(1e-6*u,1e-8);;){if(++y,y>20)throw new Error("Numerical gradient fails");if(n[o]=t[o]+l,f=e(n),n[o]=t[o]-l,a=e(n),n[o]=t[o],isNaN(f)||isNaN(a)){l/=16;continue}if(m[o]=(f-a)/(2*l),B=t[o]-l,D=t[o],A=t[o]+l,b=(f-u)/l,g=(u-a)/l,j=i(p(m[o]),p(u),p(f),p(a),p(B),p(D),p(A),1e-8),h=d(i(p(b-m[o]),p(g-m[o]),p(b-g))/j,l/j),h>s)l/=16;else break}return m},numeric.uncmin=function(e,t,r,u,i,o,n){var f=numeric.gradient;typeof n=="undefined"&&(n={}),typeof r=="undefined"&&(r=1e-8),typeof u=="undefined"&&(u=function(q){return f(e,q)}),typeof i=="undefined"&&(i=1e3),t=numeric.clone(t);var a=t.length,m=e(t),c,v;if(isNaN(m))throw new Error("uncmin: f(x0) is a NaN!");var h=Math.max,s=numeric.norm2;r=h(r,numeric.epsilon);var p,d,B,D=n.Hinv||numeric.identity(a),A=numeric.dot,y=numeric.inv,b=numeric.sub,g=numeric.add,j=numeric.tensor,l=numeric.div,F=numeric.mul,E=numeric.all,M=numeric.isFinite,_=numeric.neg,w=0,C,P,S,k,U,N,Y,G="";for(d=u(t);w<i;){if(typeof o=="function"&&o(w,t,m,d,D)){G="Callback returned true";break}if(!E(M(d))){G="Gradient has Infinity or NaN";break}if(p=_(A(D,d)),!E(M(p))){G="Search direction has Infinity or NaN";break}if(Y=s(p),Y<r){G="Newton step smaller than tol";break}for(N=1,v=A(d,p),P=t;w<i&&!(N*Y<r);){if(C=F(p,N),P=g(t,C),c=e(P),c-m>=.1*N*v||isNaN(c)){N*=.5,++w;continue}break}if(N*Y<r){G="Line search step size smaller than tol";break}if(w===i){G="maxit reached during line search";break}B=u(P),S=b(B,d),U=A(S,C),k=A(D,S),D=b(g(D,F((U+A(S,k))/(U*U),j(C,C))),l(g(j(k,C),j(C,k)),U)),t=P,m=c,d=B,++w}return{solution:t,f:m,gradient:d,invHessian:D,iterations:w,message:G}},numeric.Dopri=function(e,t,r,u,i,o,n){this.x=e,this.y=t,this.f=r,this.ymid=u,this.iterations=i,this.events=n,this.message=o},numeric.Dopri.prototype._at=function(e,t){function r(l){return l*l}var u=this,i=u.x,o=u.y,n=u.f,f=u.ymid,a=i.length,m,c,v,h,s,p,e,d,B=.5,D=numeric.add,A=numeric.mul,y=numeric.sub,b,g,j;return m=i[t],c=i[t+1],h=o[t],s=o[t+1],d=c-m,v=m+B*d,p=f[t],b=y(n[t],A(h,1/(m-v)+2/(m-c))),g=y(n[t+1],A(s,1/(c-v)+2/(c-m))),j=[r(e-c)*(e-v)/r(m-c)/(m-v),r(e-m)*r(e-c)/r(m-v)/r(c-v),r(e-m)*(e-v)/r(c-m)/(c-v),(e-m)*r(e-c)*(e-v)/r(m-c)/(m-v),(e-c)*r(e-m)*(e-v)/r(m-c)/(c-v)],D(D(D(D(A(h,j[0]),A(p,j[1])),A(s,j[2])),A(b,j[3])),A(g,j[4]))},numeric.Dopri.prototype.at=function(e){var t,r,u,i=Math.floor;if(typeof e!="number"){var o=e.length,n=Array(o);for(t=o-1;t!==-1;--t)n[t]=this.at(e[t]);return n}var f=this.x;for(t=0,r=f.length-1;r-t>1;)u=i(.5*(t+r)),f[u]<=e?t=u:r=u;return this._at(e,t)},numeric.dopri=function(e,t,r,u,i,o,n){typeof i=="undefined"&&(i=1e-6),typeof o=="undefined"&&(o=1e3);var f=[e],a=[r],m=[u(e,r)],c,v,h,s,p,d,B=[],D=1/5,A=[3/40,9/40],y=[44/45,-56/15,32/9],b=[19372/6561,-25360/2187,64448/6561,-212/729],g=[9017/3168,-355/33,46732/5247,49/176,-5103/18656],j=[35/384,0,500/1113,125/192,-2187/6784,11/84],l=[.5*6025192743/30085553152,0,.5*51252292925/65400821598,.5*-2691868925/45128329728,.5*187940372067/1594534317056,.5*-1776094331/19743644256,.5*11237099/235043384],F=[1/5,3/10,4/5,8/9,1,1],E=[-71/57600,0,71/16695,-71/1920,17253/339200,-22/525,1/40],M=0,_,w,C=(t-e)/10,P=0,S=numeric.add,k=numeric.mul,U,N,Y=Math.min,G=Math.abs,q=numeric.norminf,V=Math.pow,$=numeric.any,X=numeric.lt,L=numeric.and,O=numeric.sub,Q,I,W,R=new numeric.Dopri(f,a,m,B,-1,"");for(typeof n=="function"&&(Q=n(e,r));e<t&&P<o;){if(++P,e+C>t&&(C=t-e),c=u(e+F[0]*C,S(r,k(D*C,m[M]))),v=u(e+F[1]*C,S(S(r,k(A[0]*C,m[M])),k(A[1]*C,c))),h=u(e+F[2]*C,S(S(S(r,k(y[0]*C,m[M])),k(y[1]*C,c)),k(y[2]*C,v))),s=u(e+F[3]*C,S(S(S(S(r,k(b[0]*C,m[M])),k(b[1]*C,c)),k(b[2]*C,v)),k(b[3]*C,h))),p=u(e+F[4]*C,S(S(S(S(S(r,k(g[0]*C,m[M])),k(g[1]*C,c)),k(g[2]*C,v)),k(g[3]*C,h)),k(g[4]*C,s))),U=S(S(S(S(S(r,k(m[M],C*j[0])),k(v,C*j[2])),k(h,C*j[3])),k(s,C*j[4])),k(p,C*j[5])),d=u(e+C,U),_=S(S(S(S(S(k(m[M],C*E[0]),k(v,C*E[2])),k(h,C*E[3])),k(s,C*E[4])),k(p,C*E[5])),k(d,C*E[6])),typeof _=="number"?N=G(_):N=q(_),N>i){if(C=.2*C*V(i/N,.25),e+C===e){R.msg="Step size became too small";break}continue}if(B[M]=S(S(S(S(S(S(r,k(m[M],C*l[0])),k(v,C*l[2])),k(h,C*l[3])),k(s,C*l[4])),k(p,C*l[5])),k(d,C*l[6])),++M,f[M]=e+C,a[M]=U,m[M]=d,typeof n=="function"){var J,K=e,Z=e+.5*C,z;if(I=n(Z,B[M-1]),W=L(X(Q,0),X(0,I)),$(W)||(K=Z,Z=e+C,Q=I,I=n(Z,U),W=L(X(Q,0),X(0,I))),$(W)){for(var ir,er,nr=0,H=1,rr=1;;){if(typeof Q=="number")z=(rr*I*K-H*Q*Z)/(rr*I-H*Q);else for(z=Z,w=Q.length-1;w!==-1;--w)Q[w]<0&&I[w]>0&&(z=Y(z,(rr*I[w]*K-H*Q[w]*Z)/(rr*I[w]-H*Q[w])));if(z<=K||z>=Z)break;J=R._at(z,M-1),er=n(z,J),ir=L(X(Q,0),X(0,er)),$(ir)?(Z=z,I=er,W=ir,rr=1,nr===-1?H*=.5:H=1,nr=-1):(K=z,Q=er,H=1,nr===1?rr*=.5:rr=1,nr=1)}return U=R._at(.5*(e+z),M-1),R.f[M]=u(z,J),R.x[M]=z,R.y[M]=J,R.ymid[M-1]=U,R.events=W,R.iterations=P,R}}e+=C,r=U,Q=I,C=Y(.8*C*V(i/N,.25),4*C)}return R.iterations=P,R},numeric.LU=function(x,e){e=e||!1;var t=Math.abs,r,u,i,o,n,f,a,m,c,v=x.length,h=v-1,s=new Array(v);for(e||(x=numeric.clone(x)),i=0;i<v;++i){for(a=i,f=x[i],c=t(f[i]),u=i+1;u<v;++u)o=t(x[u][i]),c<o&&(c=o,a=u);for(s[i]=a,a!=i&&(x[i]=x[a],x[a]=f,f=x[i]),n=f[i],r=i+1;r<v;++r)x[r][i]/=n;for(r=i+1;r<v;++r){for(m=x[r],u=i+1;u<h;++u)m[u]-=m[i]*f[u],++u,m[u]-=m[i]*f[u];u===h&&(m[u]-=m[i]*f[u])}}return{LU:x,P:s}},numeric.LUsolve=function(e,t){var r,u,i=e.LU,o=i.length,n=numeric.clone(t),f=e.P,a,m,c;for(r=o-1;r!==-1;--r)n[r]=t[r];for(r=0;r<o;++r)for(a=f[r],f[r]!==r&&(c=n[r],n[r]=n[a],n[a]=c),m=i[r],u=0;u<r;++u)n[r]-=n[u]*m[u];for(r=o-1;r>=0;--r){for(m=i[r],u=r+1;u<o;++u)n[r]-=n[u]*m[u];n[r]/=m[r]}return n},numeric.solve=function(e,t,r){return numeric.LUsolve(numeric.LU(e,r),t)},numeric.echelonize=function(e){var t=numeric.dim(e),r=t[0],u=t[1],i=numeric.identity(r),o=Array(r),n,f,a,m,c,v,h,s,p=Math.abs,d=numeric.diveq;for(e=numeric.clone(e),n=0;n<r;++n){for(a=0,c=e[n],v=i[n],f=1;f<u;++f)p(c[a])<p(c[f])&&(a=f);for(o[n]=a,d(v,c[a]),d(c,c[a]),f=0;f<r;++f)if(f!==n){for(h=e[f],s=h[a],m=u-1;m!==-1;--m)h[m]-=c[m]*s;for(h=i[f],m=r-1;m!==-1;--m)h[m]-=v[m]*s}}return{I:i,A:e,P:o}},numeric.__solveLP=function(e,t,r,u,i,o,n){var f=numeric.sum,a=numeric.log,m=numeric.mul,c=numeric.sub,v=numeric.dot,h=numeric.div,s=numeric.add,p=e.length,d=r.length,B,D=!1,A=0,y=1,b=numeric.transpose(t),g=numeric.svd,j=numeric.transpose,l=numeric.leq,F=Math.sqrt,E=Math.abs,M=numeric.muleq,_=numeric.norminf,w=numeric.any,C=Math.min,P=numeric.all,S=numeric.gt,k=Array(p),U=Array(d),N=numeric.rep([d],1),Y,G=numeric.solve,q=c(r,v(t,o)),V,$=v(e,e),X;for(V=A;V<i;++V){var L,O;for(L=d-1;L!==-1;--L)U[L]=h(t[L],q[L]);var Q=j(U);for(L=p-1;L!==-1;--L)k[L]=f(Q[L]);y=.25*E($/v(e,k));var I=100*F($/v(k,k));for((!isFinite(y)||y>I)&&(y=I),X=s(e,m(y,k)),Y=v(Q,U),L=p-1;L!==-1;--L)Y[L][L]+=1;O=G(Y,h(X,y),!0);var W=h(q,v(t,O)),R=1;for(L=d-1;L!==-1;--L)W[L]<0&&(R=C(R,-.999*W[L]));if(B=c(o,m(O,R)),q=c(r,v(t,B)),!P(S(q,0)))return{solution:o,message:"",iterations:V};if(o=B,y<u)return{solution:B,message:"",iterations:V};if(n){var J=v(e,X),K=v(t,X);for(D=!0,L=d-1;L!==-1;--L)if(J*K[L]<0){D=!1;break}}else o[p-1]>=0?D=!1:D=!0;if(D)return{solution:B,message:"Unbounded",iterations:V}}return{solution:o,message:"maximum iteration count exceeded",iterations:V}},numeric._solveLP=function(e,t,r,u,i){var o=e.length,n=r.length,f,a=numeric.sum,m=numeric.log,c=numeric.mul,v=numeric.sub,h=numeric.dot,s=numeric.div,p=numeric.add,d=numeric.rep([o],0).concat([1]),B=numeric.rep([n,1],-1),D=numeric.blockMatrix([[t,B]]),A=r,f=numeric.rep([o],0).concat(Math.max(0,numeric.sup(numeric.neg(r)))+1),y=numeric.__solveLP(d,D,A,u,i,f,!1),b=numeric.clone(y.solution);b.length=o;var g=numeric.inf(v(r,h(t,b)));if(g<0)return{solution:NaN,message:"Infeasible",iterations:y.iterations};var j=numeric.__solveLP(e,t,r,u,i-y.iterations,b,!0);return j.iterations+=y.iterations,j},numeric.solveLP=function(e,t,r,u,i,o,n){if(typeof n=="undefined"&&(n=1e3),typeof o=="undefined"&&(o=numeric.epsilon),typeof u=="undefined")return numeric._solveLP(e,t,r,o,n);var f=u.length,a=u[0].length,m=t.length,c=numeric.echelonize(u),v=numeric.rep([a],0),h=c.P,s=[],p;for(p=h.length-1;p!==-1;--p)v[h[p]]=1;for(p=a-1;p!==-1;--p)v[p]===0&&s.push(p);var d=numeric.getRange,B=numeric.linspace(0,f-1),D=numeric.linspace(0,m-1),A=d(u,B,s),y=d(t,D,h),b=d(t,D,s),g=numeric.dot,j=numeric.sub,l=g(y,c.I),F=j(b,g(l,A)),E=j(r,g(l,i)),M=Array(h.length),_=Array(s.length);for(p=h.length-1;p!==-1;--p)M[p]=e[h[p]];for(p=s.length-1;p!==-1;--p)_[p]=e[s[p]];var w=j(_,g(M,g(c.I,A))),C=numeric._solveLP(w,F,E,o,n),P=C.solution;if(P!==P)return C;var S=g(c.I,j(i,g(A,P))),k=Array(e.length);for(p=h.length-1;p!==-1;--p)k[h[p]]=S[p];for(p=s.length-1;p!==-1;--p)k[s[p]]=P[p];return{solution:k,message:C.message,iterations:C.iterations}},numeric.MPStoLP=function(e){e instanceof String&&e.split(`
`);var t=0,r=["Initial state","NAME","ROWS","COLUMNS","RHS","BOUNDS","ENDATA"],u=e.length,i,o,n,f=0,a={},m=[],c=0,v={},h=0,s,p=[],d=[],B=[];function D(j){throw new Error("MPStoLP: "+j+`
Line `+i+": "+e[i]+`
Current state: `+r[t]+`
`)}for(i=0;i<u;++i){n=e[i];var A=n.match(/\S*/g),y=[];for(o=0;o<A.length;++o)A[o]!==""&&y.push(A[o]);if(y.length!==0){for(o=0;o<r.length&&n.substr(0,r[o].length)!==r[o];++o);if(o<r.length){if(t=o,o===1&&(s=y[1]),o===6)return{name:s,c:p,A:numeric.transpose(d),b:B,rows:a,vars:v};continue}switch(t){case 0:case 1:D("Unexpected line");case 2:switch(y[0]){case"N":f===0?f=y[1]:D("Two or more N rows");break;case"L":a[y[1]]=c,m[c]=1,B[c]=0,++c;break;case"G":a[y[1]]=c,m[c]=-1,B[c]=0,++c;break;case"E":a[y[1]]=c,m[c]=0,B[c]=0,++c;break;default:D("Parse error "+numeric.prettyPrint(y))}break;case 3:v.hasOwnProperty(y[0])||(v[y[0]]=h,p[h]=0,d[h]=numeric.rep([c],0),++h);var b=v[y[0]];for(o=1;o<y.length;o+=2){if(y[o]===f){p[b]=parseFloat(y[o+1]);continue}var g=a[y[o]];d[b][g]=(m[g]<0?-1:1)*parseFloat(y[o+1])}break;case 4:for(o=1;o<y.length;o+=2)B[a[y[o]]]=(m[a[y[o]]]<0?-1:1)*parseFloat(y[o+1]);break;case 5:break;case 6:D("Internal error")}}}D("Reached end of file without ENDATA")},numeric.seedrandom={pow:Math.pow,random:Math.random},function(x,e,t,r,u,i,o){e.seedrandom=function(v,h){var s=[],p;return v=a(f(h?[v,x]:arguments.length?v:[new Date().getTime(),x,window],3),s),p=new n(s),a(p.S,x),e.random=function(){for(var B=p.g(r),D=o,A=0;B<u;)B=(B+A)*t,D*=t,A=p.g(1);for(;B>=i;)B/=2,D/=2,A>>>=1;return(B+A)/D},v};function n(c){var v,h,s=this,p=c.length,d=0,B=s.i=s.j=s.m=0;for(s.S=[],s.c=[],p||(c=[p++]);d<t;)s.S[d]=d++;for(d=0;d<t;d++)v=s.S[d],B=m(B+v+c[d%p]),h=s.S[B],s.S[d]=h,s.S[B]=v;s.g=function(A){var y=s.S,b=m(s.i+1),g=y[b],j=m(s.j+g),l=y[j];y[b]=l,y[j]=g;for(var F=y[m(g+l)];--A;)b=m(b+1),g=y[b],j=m(j+g),l=y[j],y[b]=l,y[j]=g,F=F*t+y[m(g+l)];return s.i=b,s.j=j,F},s.g(t)}function f(c,v,h,s,p){if(h=[],p=typeof c,v&&p=="object"){for(s in c)if(s.indexOf("S")<5)try{h.push(f(c[s],v-1))}catch(d){}}return h.length?h:c+(p!="string"?"\0":"")}function a(c,v,h,s){for(c+="",h=0,s=0;s<c.length;s++)v[m(s)]=m((h^=v[m(s)]*19)+c.charCodeAt(s));c="";for(s in v)c+=String.fromCharCode(v[s]);return c}function m(c){return c&t-1}o=e.pow(t,r),u=e.pow(2,u),i=u*2,a(e.random(),x)}([],numeric.seedrandom,256,6,52),function(x){function e(f){if(typeof f!="object")return f;var a=[],m,c=f.length;for(m=0;m<c;m++)a[m+1]=e(f[m]);return a}function t(f){if(typeof f!="object")return f;var a=[],m,c=f.length;for(m=1;m<c;m++)a[m-1]=t(f[m]);return a}function r(f,a,m){var c,v,h,s,p;for(h=1;h<=m;h=h+1){for(f[h][h]=1/f[h][h],p=-f[h][h],c=1;c<h;c=c+1)f[c][h]=p*f[c][h];if(s=h+1,m<s)break;for(v=s;v<=m;v=v+1)for(p=f[h][v],f[h][v]=0,c=1;c<=h;c=c+1)f[c][v]=f[c][v]+p*f[c][h]}}function u(f,a,m,c){var v,h,s,p;for(h=1;h<=m;h=h+1){for(p=0,v=1;v<h;v=v+1)p=p+f[v][h]*c[v];c[h]=(c[h]-p)/f[h][h]}for(s=1;s<=m;s=s+1)for(h=m+1-s,c[h]=c[h]/f[h][h],p=-c[h],v=1;v<h;v=v+1)c[v]=c[v]+p*f[v][h]}function i(f,a,m,c){var v,h,s,p,d,B;for(h=1;h<=m;h=h+1){if(c[1]=h,B=0,s=h-1,s<1){if(B=f[h][h]-B,B<=0)break;f[h][h]=Math.sqrt(B)}else{for(p=1;p<=s;p=p+1){for(d=f[p][h],v=1;v<p;v=v+1)d=d-f[v][h]*f[v][p];d=d/f[p][p],f[p][h]=d,B=B+d*d}if(B=f[h][h]-B,B<=0)break;f[h][h]=Math.sqrt(B)}c[1]=0}}function o(f,a,m,c,v,h,s,p,d,B,D,A,y,b,g,j){var l,F,E,M,_,w,C,P,S,k,U,N,Y,G,q,V,$,X,L,O,Q,I,W,R,J,K,Z;Y=Math.min(c,B),E=2*c+Y*(Y+5)/2+2*B+1,R=1e-60;do R=R+R,J=1+.1*R,K=1+.2*R;while(J<=1||K<=1);for(l=1;l<=c;l=l+1)g[l]=a[l];for(l=c+1;l<=E;l=l+1)g[l]=0;for(l=1;l<=B;l=l+1)A[l]=0;if(_=[],j[1]===0){if(i(f,m,c,_),_[1]!==0){j[1]=2;return}u(f,m,c,a),r(f,m,c)}else{for(F=1;F<=c;F=F+1)for(v[F]=0,l=1;l<=F;l=l+1)v[F]=v[F]+f[l][F]*a[l];for(F=1;F<=c;F=F+1)for(a[F]=0,l=F;l<=c;l=l+1)a[F]=a[F]+f[F][l]*v[l]}for(h[1]=0,F=1;F<=c;F=F+1)for(v[F]=a[F],h[1]=h[1]+g[F]*v[F],g[F]=0,l=F+1;l<=c;l=l+1)f[l][F]=0;for(h[1]=-h[1]/2,j[1]=0,C=c,P=C+c,U=P+Y,S=U+Y+1,k=S+Y*(Y+1)/2,G=k+B,l=1;l<=B;l=l+1){for(V=0,F=1;F<=c;F=F+1)V=V+s[F][l]*s[F][l];g[G+l]=Math.sqrt(V)}y=0,b[1]=0,b[2]=0;function z(){for(b[1]=b[1]+1,E=k,l=1;l<=B;l=l+1){for(E=E+1,V=-p[l],F=1;F<=c;F=F+1)V=V+s[F][l]*v[F];if(Math.abs(V)<R&&(V=0),l>D)g[E]=V;else if(g[E]=-Math.abs(V),V>0){for(F=1;F<=c;F=F+1)s[F][l]=-s[F][l];p[l]=-p[l]}}for(l=1;l<=y;l=l+1)g[k+A[l]]=0;for(N=0,q=0,l=1;l<=B;l=l+1)g[k+l]<q*g[G+l]&&(N=l,q=g[k+l]/g[G+l]);return N===0?999:0}function ir(){for(l=1;l<=c;l=l+1){for(V=0,F=1;F<=c;F=F+1)V=V+f[F][l]*s[F][N];g[l]=V}for(M=C,l=1;l<=c;l=l+1)g[M+l]=0;for(F=y+1;F<=c;F=F+1)for(l=1;l<=c;l=l+1)g[M+l]=g[M+l]+f[l][F]*g[F];for(I=!0,l=y;l>=1;l=l-1){for(V=g[l],E=S+l*(l+3)/2,M=E-l,F=l+1;F<=y;F=F+1)V=V-g[E]*g[P+F],E=E+F;if(V=V/g[M],g[P+l]=V,A[l]<D||V<0)break;I=!1,w=l}if(!I)for($=g[U+w]/g[P+w],l=1;l<=y&&!(A[l]<D||g[P+l]<0);l=l+1)q=g[U+l]/g[P+l],q<$&&($=q,w=l);for(V=0,l=C+1;l<=C+c;l=l+1)V=V+g[l]*g[l];if(Math.abs(V)<=R){if(I)return j[1]=1,999;for(l=1;l<=y;l=l+1)g[U+l]=g[U+l]-$*g[P+l];return g[U+y+1]=g[U+y+1]+$,700}else{for(V=0,l=1;l<=c;l=l+1)V=V+g[C+l]*s[l][N];for(X=-g[k+N]/V,W=!0,I||$<X&&(X=$,W=!1),l=1;l<=c;l=l+1)v[l]=v[l]+X*g[C+l],Math.abs(v[l])<R&&(v[l]=0);for(h[1]=h[1]+X*V*(X/2+g[U+y+1]),l=1;l<=y;l=l+1)g[U+l]=g[U+l]-X*g[P+l];if(g[U+y+1]=g[U+y+1]+X,W){for(y=y+1,A[y]=N,E=S+(y-1)*y/2+1,l=1;l<=y-1;l=l+1)g[E]=g[l],E=E+1;if(y===c)g[E]=g[c];else{for(l=c;l>=y+1&&!(g[l]===0||(L=Math.max(Math.abs(g[l-1]),Math.abs(g[l])),O=Math.min(Math.abs(g[l-1]),Math.abs(g[l])),g[l-1]>=0?q=Math.abs(L*Math.sqrt(1+O*O/(L*L))):q=-Math.abs(L*Math.sqrt(1+O*O/(L*L))),L=g[l-1]/q,O=g[l]/q,L===1));l=l-1)if(L===0)for(g[l-1]=O*q,F=1;F<=c;F=F+1)q=f[F][l-1],f[F][l-1]=f[F][l],f[F][l]=q;else for(g[l-1]=q,Q=O/(1+L),F=1;F<=c;F=F+1)q=L*f[F][l-1]+O*f[F][l],f[F][l]=Q*(f[F][l-1]+q)-f[F][l],f[F][l-1]=q;g[E]=g[y]}}else{for(V=-p[N],F=1;F<=c;F=F+1)V=V+v[F]*s[F][N];if(N>D)g[k+N]=V;else if(g[k+N]=-Math.abs(V),V>0){for(F=1;F<=c;F=F+1)s[F][N]=-s[F][N];p[N]=-p[N]}return 700}}return 0}function er(){if(E=S+w*(w+1)/2+1,M=E+w,g[M]===0||(L=Math.max(Math.abs(g[M-1]),Math.abs(g[M])),O=Math.min(Math.abs(g[M-1]),Math.abs(g[M])),g[M-1]>=0?q=Math.abs(L*Math.sqrt(1+O*O/(L*L))):q=-Math.abs(L*Math.sqrt(1+O*O/(L*L))),L=g[M-1]/q,O=g[M]/q,L===1))return 798;if(L===0){for(l=w+1;l<=y;l=l+1)q=g[M-1],g[M-1]=g[M],g[M]=q,M=M+l;for(l=1;l<=c;l=l+1)q=f[l][w],f[l][w]=f[l][w+1],f[l][w+1]=q}else{for(Q=O/(1+L),l=w+1;l<=y;l=l+1)q=L*g[M-1]+O*g[M],g[M]=Q*(g[M-1]+q)-g[M],g[M-1]=q,M=M+l;for(l=1;l<=c;l=l+1)q=L*f[l][w]+O*f[l][w+1],f[l][w+1]=Q*(f[l][w]+q)-f[l][w+1],f[l][w]=q}return 0}function nr(){for(M=E-w,l=1;l<=w;l=l+1)g[M]=g[E],E=E+1,M=M+1;return g[U+w]=g[U+w+1],A[w]=A[w+1],w=w+1,w<y?797:0}function H(){return g[U+y]=g[U+y+1],g[U+y+1]=0,A[y]=0,y=y-1,b[2]=b[2]+1,0}for(Z=0;;){if(Z=z(),Z===999)return;for(;Z=ir(),Z!==0;){if(Z===999)return;if(Z===700)if(w===y)H();else{for(;er(),Z=nr(),Z===797;);H()}}}}function n(f,a,m,c,v,h){f=e(f),a=e(a),m=e(m);var s,p,d,B,D,A=[],y=[],b=[],g=[],j=[],l;if(v=v||0,h=h?e(h):[void 0,0],c=c?e(c):[],p=f.length-1,d=m[1].length-1,!c)for(s=1;s<=d;s=s+1)c[s]=0;for(s=1;s<=d;s=s+1)y[s]=0;for(B=0,D=Math.min(p,d),s=1;s<=p;s=s+1)b[s]=0;for(A[1]=0,s=1;s<=2*p+D*(D+5)/2+2*d+1;s=s+1)g[s]=0;for(s=1;s<=2;s=s+1)j[s]=0;return o(f,a,p,p,b,A,m,c,p,d,v,y,B,j,g,h),l="",h[1]===1&&(l="constraints are inconsistent, no solution!"),h[1]===2&&(l="matrix D in quadratic function is not positive definite!"),{solution:t(b),value:t(A),unconstrained_solution:t(a),iterations:t(j),iact:t(y),message:l}}x.solveQP=n}(numeric),numeric.svd=function(e){var t,r=numeric.epsilon,u=1e-64/r,i=50,o=0,n=0,f=0,a=0,m=0,c=numeric.clone(e),v=c.length,h=c[0].length;if(v<h)throw"Need more rows than columns";var s=new Array(h),p=new Array(h);for(n=0;n<h;n++)s[n]=p[n]=0;var d=numeric.rep([h,h],0);function B(_,w){return _=Math.abs(_),w=Math.abs(w),_>w?_*Math.sqrt(1+w*w/_/_):w==0?_:w*Math.sqrt(1+_*_/w/w)}var D=0,A=0,y=0,b=0,g=0,j=0,l=0;for(n=0;n<h;n++){for(s[n]=A,l=0,m=n+1,f=n;f<v;f++)l+=c[f][n]*c[f][n];if(l<=u)A=0;else for(D=c[n][n],A=Math.sqrt(l),D>=0&&(A=-A),y=D*A-l,c[n][n]=D-A,f=m;f<h;f++){for(l=0,a=n;a<v;a++)l+=c[a][n]*c[a][f];for(D=l/y,a=n;a<v;a++)c[a][f]+=D*c[a][n]}for(p[n]=A,l=0,f=m;f<h;f++)l=l+c[n][f]*c[n][f];if(l<=u)A=0;else{for(D=c[n][n+1],A=Math.sqrt(l),D>=0&&(A=-A),y=D*A-l,c[n][n+1]=D-A,f=m;f<h;f++)s[f]=c[n][f]/y;for(f=m;f<v;f++){for(l=0,a=m;a<h;a++)l+=c[f][a]*c[n][a];for(a=m;a<h;a++)c[f][a]+=l*s[a]}}g=Math.abs(p[n])+Math.abs(s[n]),g>b&&(b=g)}for(n=h-1;n!=-1;n+=-1){if(A!=0){for(y=A*c[n][n+1],f=m;f<h;f++)d[f][n]=c[n][f]/y;for(f=m;f<h;f++){for(l=0,a=m;a<h;a++)l+=c[n][a]*d[a][f];for(a=m;a<h;a++)d[a][f]+=l*d[a][n]}}for(f=m;f<h;f++)d[n][f]=0,d[f][n]=0;d[n][n]=1,A=s[n],m=n}for(n=h-1;n!=-1;n+=-1){for(m=n+1,A=p[n],f=m;f<h;f++)c[n][f]=0;if(A!=0){for(y=c[n][n]*A,f=m;f<h;f++){for(l=0,a=m;a<v;a++)l+=c[a][n]*c[a][f];for(D=l/y,a=n;a<v;a++)c[a][f]+=D*c[a][n]}for(f=n;f<v;f++)c[f][n]=c[f][n]/A}else for(f=n;f<v;f++)c[f][n]=0;c[n][n]+=1}for(r=r*b,a=h-1;a!=-1;a+=-1)for(var F=0;F<i;F++){var E=!1;for(m=a;m!=-1;m+=-1){if(Math.abs(s[m])<=r){E=!0;break}if(Math.abs(p[m-1])<=r)break}if(!E){o=0,l=1;var M=m-1;for(n=m;n<a+1&&(D=l*s[n],s[n]=o*s[n],!(Math.abs(D)<=r));n++)for(A=p[n],y=B(D,A),p[n]=y,o=A/y,l=-D/y,f=0;f<v;f++)g=c[f][M],j=c[f][n],c[f][M]=g*o+j*l,c[f][n]=-g*l+j*o}if(j=p[a],m==a){if(j<0)for(p[a]=-j,f=0;f<h;f++)d[f][a]=-d[f][a];break}if(F>=i-1)throw"Error: no convergence.";for(b=p[m],g=p[a-1],A=s[a-1],y=s[a],D=((g-j)*(g+j)+(A-y)*(A+y))/(2*y*g),A=B(D,1),D<0?D=((b-j)*(b+j)+y*(g/(D-A)-y))/b:D=((b-j)*(b+j)+y*(g/(D+A)-y))/b,o=1,l=1,n=m+1;n<a+1;n++){for(A=s[n],g=p[n],y=l*A,A=o*A,j=B(D,y),s[n-1]=j,o=D/j,l=y/j,D=b*o+A*l,A=-b*l+A*o,y=g*l,g=g*o,f=0;f<h;f++)b=d[f][n-1],j=d[f][n],d[f][n-1]=b*o+j*l,d[f][n]=-b*l+j*o;for(j=B(D,y),p[n-1]=j,o=D/j,l=y/j,D=o*A+l*g,b=-l*A+o*g,f=0;f<v;f++)g=c[f][n-1],j=c[f][n],c[f][n-1]=g*o+j*l,c[f][n]=-g*l+j*o}s[m]=0,s[a]=D,p[a]=b}for(n=0;n<p.length;n++)p[n]<r&&(p[n]=0);for(n=0;n<h;n++)for(f=n-1;f>=0;f--)if(p[f]<p[n]){for(o=p[f],p[f]=p[n],p[n]=o,a=0;a<c.length;a++)t=c[a][n],c[a][n]=c[a][f],c[a][f]=t;for(a=0;a<d.length;a++)t=d[a][n],d[a][n]=d[a][f],d[a][f]=t;n=f}return{U:c,S:p,V:d}}});export default numeric1_2_6;
