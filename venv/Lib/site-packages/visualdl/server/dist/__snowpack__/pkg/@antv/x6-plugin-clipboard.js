import{M as f,s as m,G as l,d as y,B as u}from"../common/html-43a4a009.js";class O{constructor(){this.cells=[]}copy(t,e,o={}){this.options=Object.assign({},o);const n=(f.isModel(e)?e:e.model).cloneSubGraph(t,o);this.cells=m(Object.keys(n).map(r=>n[r]),r=>r.isEdge()?2:1),this.serialize(o)}cut(t,e,o={}){this.copy(t,e,o),(l.isGraph(e)?e.model:e).batchUpdate("cut",()=>{t.forEach(n=>n.remove())})}paste(t,e={}){const o=Object.assign(Object.assign({},this.options),e),{offset:s,edgeProps:n,nodeProps:r}=o;let a=20,d=20;s&&(a=typeof s=="number"?s:s.dx,d=typeof s=="number"?s:s.dy),this.deserialize(o);const h=this.cells;h.forEach(c=>{c.model=null,c.removeProp("zIndex"),(a||d)&&c.translate(a,d),r&&c.isNode()&&c.prop(r),n&&c.isEdge()&&c.prop(n)});const b=l.isGraph(t)?t.model:t;return b.batchUpdate("paste",()=>{b.addCells(this.cells)}),this.copy(h,t,e),h}serialize(t){t.useLocalStorage!==!1&&p.save(this.cells)}deserialize(t){if(t.useLocalStorage){const e=p.fetch();e&&(this.cells=e)}}isEmpty(){return this.cells.length<=0}clean(){this.options={},this.cells=[],p.clean()}}var p;(function(i){const t=`${y.prefixCls}.clipboard.cells`;function e(n){if(window.localStorage){const r=n.map(a=>a.toJSON());localStorage.setItem(t,JSON.stringify(r))}}i.save=e;function o(){if(window.localStorage){const n=localStorage.getItem(t),r=n?JSON.parse(n):[];if(r)return f.fromJSON(r)}}i.fetch=o;function s(){window.localStorage&&localStorage.removeItem(t)}i.clean=s})(p||(p={})),l.prototype.isClipboardEnabled=function(){const i=this.getPlugin("clipboard");return i?i.isEnabled():!1},l.prototype.enableClipboard=function(){const i=this.getPlugin("clipboard");return i&&i.enable(),this},l.prototype.disableClipboard=function(){const i=this.getPlugin("clipboard");return i&&i.disable(),this},l.prototype.toggleClipboard=function(i){const t=this.getPlugin("clipboard");return t&&t.toggleEnabled(i),this},l.prototype.isClipboardEmpty=function(){const i=this.getPlugin("clipboard");return i?i.isEmpty():!0},l.prototype.getCellsInClipboard=function(){const i=this.getPlugin("clipboard");return i?i.getCellsInClipboard():[]},l.prototype.cleanClipboard=function(){const i=this.getPlugin("clipboard");return i&&i.clean(),this},l.prototype.copy=function(i,t){const e=this.getPlugin("clipboard");return e&&e.copy(i,t),this},l.prototype.cut=function(i,t){const e=this.getPlugin("clipboard");return e&&e.cut(i,t),this},l.prototype.paste=function(i,t){const e=this.getPlugin("clipboard");return e?e.paste(i,t):[]};var E=function(i,t,e,o){var s=arguments.length,n=s<3?t:o===null?o=Object.getOwnPropertyDescriptor(t,e):o,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(i,t,e,o);else for(var a=i.length-1;a>=0;a--)(r=i[a])&&(n=(s<3?r(n):s>3?r(t,e,n):r(t,e))||n);return s>3&&n&&Object.defineProperty(t,e,n),n},j=function(i,t){var e={};for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&t.indexOf(o)<0&&(e[o]=i[o]);if(i!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,o=Object.getOwnPropertySymbols(i);s<o.length;s++)t.indexOf(o[s])<0&&Object.prototype.propertyIsEnumerable.call(i,o[s])&&(e[o[s]]=i[o[s]]);return e};class g extends u{constructor(t){super();this.name="clipboard",this.options=t}init(t){this.graph=t,this.clipboardImpl=new O,this.clipboardImpl.deserialize(this.options)}isEnabled(){return!this.disabled}enable(){return this.disabled&&(this.options.enabled=!0),this}disable(){return this.disabled||(this.options.enabled=!1),this}toggleEnabled(t){return t!=null?t!==this.isEnabled()&&(t?this.enable():this.disable()):this.isEnabled()?this.disable():this.enable(),this}isEmpty(){return this.clipboardImpl.isEmpty()}getCellsInClipboard(){return this.cells}clean(t){return(!this.disabled||t)&&(this.clipboardImpl.clean(),this.notify("clipboard:changed",{cells:[]})),this}copy(t,e={}){return this.disabled||(this.clipboardImpl.copy(t,this.graph,Object.assign(Object.assign({},this.commonOptions),e)),this.notify("clipboard:changed",{cells:t})),this}cut(t,e={}){return this.disabled||(this.clipboardImpl.cut(t,this.graph,Object.assign(Object.assign({},this.commonOptions),e)),this.notify("clipboard:changed",{cells:t})),this}paste(t={},e=this.graph){return this.disabled?[]:this.clipboardImpl.paste(e,Object.assign(Object.assign({},this.commonOptions),t))}get disabled(){return this.options.enabled!==!0}get commonOptions(){const t=this.options;return j(t,["enabled"])}get cells(){return this.clipboardImpl.cells}notify(t,e){this.trigger(t,e),this.graph.trigger(t,e)}dispose(){this.clean(!0),this.off()}}E([u.dispose()],g.prototype,"dispose",null);export{g as Clipboard};
