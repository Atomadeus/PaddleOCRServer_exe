var mediapipe=mediapipe||{},protobuf=protobuf||require("./protobuf");mediapipe.ModelFactory=class{match(t){if("pbtxt"===t.identifier.split(".").pop().toLowerCase()){const e=t.tags("pbtxt"),i=t.text;if(e.has("node")&&(-1!==i.indexOf("input_stream:")||-1!==i.indexOf("input_side_packet:")||-1!==i.indexOf("output_stream:")))return!0}return!1}open(t,e){const i=t.identifier;try{const e=protobuf.TextReader.create(t.text),i=new mediapipe.Object(e);return Promise.resolve(new mediapipe.Model(i))}catch(t){e.exception(t,!1);const s=t&&t.message?t.message:t.toString();return Promise.reject(new mediapipe.Error(s.replace(/\.$/,"")+" in '"+i+"'."))}}},mediapipe.Model=class{constructor(t){this._graphs=[new mediapipe.Graph(t)]}get format(){return"MediaPipe"}get graphs(){return this._graphs}},mediapipe.Graph=class{constructor(t){if(this._inputs=[],this._outputs=[],this._nodes=[],t){if(t.input_stream){const e=Array.isArray(t.input_stream)?t.input_stream:[t.input_stream];for(const t of e){const e=t.split(":"),i=e.length>1?e.shift():"",s=e.shift();this._inputs.push(new mediapipe.Parameter(s,[new mediapipe.Argument(s,i,null)]))}}if(t.output_stream){const e=Array.isArray(t.output_stream)?t.output_stream:[t.output_stream];for(const t of e){const e=t.split(":"),i=e.length>1?e.shift():"",s=e.shift();this._outputs.push(new mediapipe.Parameter(s,[new mediapipe.Argument(s,i,null)]))}}if(t.input_side_packet){const e=Array.isArray(t.input_side_packet)?t.input_side_packet:[t.input_side_packet];for(const t of e){const e=t.split(":"),i=e.length>1?e.shift():"",s=e.shift();this._inputs.push(new mediapipe.Parameter(s,[new mediapipe.Argument(s,i,null)]))}}if(t.output_side_packet){const e=Array.isArray(t.output_side_packet)?t.output_side_packet:[t.output_side_packet];for(const t of e){const e=t.split(":"),i=e.length>1?e.shift():"",s=e.shift();this._outputs.push(new mediapipe.Parameter(t,[new mediapipe.Argument(s,i,null)]))}}if(t.node){const e=Array.isArray(t.node)?t.node:[t.node];for(const t of e)this._nodes.push(new mediapipe.Node(t))}}}get inputs(){return this._inputs}get outputs(){return this._outputs}get nodes(){return this._nodes}},mediapipe.Node=class{constructor(t){if(this._type=t.calculator||"?",this._type=this._type.replace(/Calculator$/,""),this._inputs=[],this._outputs=[],this._attributes=[],t.input_stream){const e=[],i=Array.isArray(t.input_stream)?t.input_stream:[t.input_stream];for(const t of i){const i=t.split(":"),s=i.length>1?i.shift():"",r=i.shift();e.push(new mediapipe.Argument(r,s,null))}this._inputs.push(new mediapipe.Parameter("input_stream",e))}if(t.output_stream){const e=[],i=Array.isArray(t.output_stream)?t.output_stream:[t.output_stream];for(const t of i){const i=t.split(":"),s=i.length>1?i.shift():"",r=i.shift();e.push(new mediapipe.Argument(r,s,null))}this._outputs.push(new mediapipe.Parameter("output_stream",e))}if(t.input_side_packet){const e=[],i=Array.isArray(t.input_side_packet)?t.input_side_packet:[t.input_side_packet];for(const t of i){const i=t.split(":"),s=i.length>1?i.shift():"",r=i.shift();e.push(new mediapipe.Argument(r,s,null))}this._inputs.push(new mediapipe.Parameter("input_side_packet",e))}if(t.output_side_packet){const e=[],i=Array.isArray(t.output_side_packet)?t.output_side_packet:[t.output_side_packet];for(const t of i){const i=t.split(":"),s=i.length>1?i.shift():"",r=i.shift();e.push(new mediapipe.Argument(r,s,null))}this._outputs.push(new mediapipe.Parameter("output_side_packet",e))}const e=t.options||t.node_options||null;if(e)for(const t of Object.keys(e)){if("__type__"===t)continue;const i=e[t];this._attributes.push(new mediapipe.Attribute(t,i))}}get name(){return""}get type(){return this._type}get metadata(){return null}get inputs(){return this._inputs}get outputs(){return this._outputs}get attributes(){return this._attributes}},mediapipe.Attribute=class{constructor(t,e){this._name=t,this._value=e}get name(){return this._name}get value(){return this._value}get visible(){return!0}},mediapipe.Parameter=class{constructor(t,e){this._name=t,this._arguments=e}get name(){return this._name}get visible(){return!0}get arguments(){return this._arguments}},mediapipe.Argument=class{constructor(t,e,i){if("string"!=typeof t)throw new mediapipe.Error("Invalid argument identifier '"+JSON.stringify(t)+"'.");this._name=t,this._type=e||null,this._initializer=i||null}get name(){return this._name}get type(){return this._type?this._type:this._initializer?this._initializer.type:null}get initializer(){return this._initializer}},mediapipe.Object=class{constructor(t){t.start();let e=!1;const i=t.peek();i.startsWith("[")&&i.endsWith("]")&&(this.__type__=t.read().substring(0,i.length-1),t.match(":"),t.start(),e=!0);const s=new Set;for(;!t.end();){var r=t.tag(),p=t.peek(),n=null;if("{"===p)n=new mediapipe.Object(t);else if(p.startsWith('"')&&p.endsWith('"'))n=t.read().substring(1,p.length-1);else if("true"===p||"false"===p)n=t.read();else if(t.first())for(n=[];!t.last();){const e=t.read();isNaN(e)||n.push(parseFloat(e))}else n=isNaN(p)?t.read():parseFloat(t.read());!this[r]||Array.isArray(this[r])&&!s.has(r)||(this[r]=[this[r]],s.delete(r)),this[r]?this[r].push(n):(Array.isArray(n)&&s.add(r),this[r]=n)}e&&t.expect("}")}},mediapipe.Error=class extends Error{constructor(t){super(t),this.name="Error loading MediaPipe model."}},"undefined"!=typeof module&&"object"==typeof module.exports&&(module.exports.ModelFactory=mediapipe.ModelFactory);