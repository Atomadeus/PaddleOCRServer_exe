import{useEffect as i,useMemo as a}from"../../__snowpack__/pkg/react.js";import _ from"../utils/event.js";import{toast as d}from"../../__snowpack__/pkg/react-toastify.js";import k from"../../__snowpack__/pkg/swr.js";function m(...f){const s=f[0],{data:t,error:e,...o}=k(...f),r=a(()=>!!s&&t===void 0&&!e,[s,t,e]);return i(()=>{e&&d.error(e.message)},[e]),{data:t,error:e,loading:r,...o}}function y(...f){const[s,t,...e]=f;let o,r;e.length>1?(o=e[0],r=e[1]):e[0]!=null&&(typeof e[0]=="object"?r=e[0]:typeof e[0]=="function"&&(o=e[0]));const u=a(()=>{var l,p,c;return{...r,refreshInterval:t?(l=r==null?void 0:r.refreshInterval)!=null?l:15*1e3:0,dedupingInterval:(p=r==null?void 0:r.refreshInterval)!=null?p:15*1e3,errorRetryInterval:(c=r==null?void 0:r.refreshInterval)!=null?c:15*1e3}},[r,t]),v=a(()=>o===void 0?[s,u]:[s,o,u],[s,o,u]),{mutate:n,...h}=m(...v);return i(()=>{t&&n()},[t,n]),i(()=>(_.on("refresh",n),()=>{_.off("refresh",n)}),[n]),{mutate:n,...h}}export default m;export{y as useRunningRequest};
