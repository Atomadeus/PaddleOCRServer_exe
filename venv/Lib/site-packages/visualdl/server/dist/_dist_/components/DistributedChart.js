import s,{useEffect as w,useCallback as E}from"../../__snowpack__/pkg/react.js";import{primaryColor as v}from"../utils/style.js";import D,{Wrapper as F,useChartTheme as j}from"../hooks/useECharts.js";import{color as z}from"../utils/chart.js";import{renderToStaticMarkup as T}from"../../__snowpack__/pkg/react-dom/server.js";import B from"./TooltipTable.js";import L from"../../__snowpack__/pkg/react-spinners/GridLoader.js";import A from"../../__snowpack__/pkg/lodash/defaultsDeep.js";import{useTranslation as u}from"../../__snowpack__/pkg/react-i18next.js";export var XAxisType;(function(t){t.value="value",t.log="log",t.time="time"})(XAxisType||(XAxisType={}));export var YAxisType;(function(t){t.value="value",t.log="log"})(YAxisType||(YAxisType={}));const M=s.forwardRef(({options:t,data:a,titles:p,loading:h,zoom:g,className:d,onInit:C},y)=>{console.log(y);const{t:o}=u(["profiler","common"]),{i18n:b}=u(),{ref:x,echart:l,wrapper:_}=D({loading:!!h,zoom:g,autoFit:!0,onInit:C}),k=j(),f=E(r=>{if(r.length){const n=r.length/4-1;let e=0;const i=[],c=[];for(;e<r.length;){const m=r[e];m&&(c.push({label:m.seriesName,colors:[m.color]}),i.push(m.value)),n>=0?e+=1+n:e+=1}const S=[{label:o("timestamp")},{label:o("memory-size")+"\uFF08KB\uFF09"},{label:o("event-name")}];return T(s.createElement(B,{run:o("common:runs"),runs:c,columns:S,data:i}))}},[o]);return w(()=>{if(!a)return;const r=a,n=Object.keys(a.name).map(e=>{const c=a[e];return{name:o(e),step:"true",type:"line",smooth:!0,showSymbol:!1,symbol:"circle",symbolSize:4,emphasis:{focus:"series",itemStyle:{opacity:1,borderWidth:2,borderColor:"#fff",shadowColor:z[0],shadowBlur:2}},animationDuration:100,data:c,encode:{x:[0],y:[1]}}});if(r){const e=`Peak Memory Usage: ${p}KB`,i=A({color:["#2932E1","#00CC88","#981EFF","#066BFF","#00E2FF","#FFAA00","#E71ED5","#FF6600","#0DEBB0","#D50505"],title:{top:"0",left:"15",show:!0,text:e,textStyle:{color:"#666666",fontStyle:"PingFangSC-Regular",fontWeight:"400",fontSize:14}},legend:{type:"plain",top:0,right:0,itemGap:14,textStyle:{fontSize:14,color:"#666666"},icon:"path://M14.5,0h-12C1.1,0,0,1.1,0,2.5S1.1,5,2.5,5h12C15.9,5,17,3.9,17,2.5S15.9,0,14.5,0z",itemWidth:17,itemHeight:5},tooltip:{trigger:"axis",formatter:f,hideDelay:300,backgroundColor:"rgba(0, 0, 0, 0.6)",borderColor:"rgba(0, 0, 0, 0.6)",textStyle:{color:"#fff"},enterable:!0},grid:{left:"0",right:"20",bottom:"0",top:"62",containLabel:!0},xAxis:{crossStyle:{color:"#2932e1",type:"dashed"},label:{show:!0},axisTick:{show:!1},axisLine:{lineStyle:{color:"#CCCCCC"}},axisLabel:{color:"#666666",fontSize:12}},yAxis:{type:"value",name:o("memory-usage")+"\uFF08kB)",position:"left",axisTick:{show:!1},axisLine:{lineStyle:{color:"#CCCCCC"}},axisLabel:{color:"#666666",fontSize:12}},dataZoom:[{type:"inside",xAxisIndex:0}],series:n});l==null||l.setOption(i,{notMerge:!0})}},[t,a,p,k,b.language,l,f,o]),s.createElement(F,{ref:_,className:d},!l&&s.createElement("div",{className:"loading"},s.createElement(L,{color:v,size:"10px"})),s.createElement("div",{className:"echarts",ref:x}))});export default M;
