import*as b from"../utils/chart.js";import a,{useEffect as E,useImperativeHandle as S}from"../../__snowpack__/pkg/react.js";import{primaryColor as C}from"../utils/style.js";import T,{Wrapper as N,useChartTheme as G}from"../hooks/useECharts.js";import I from"../../__snowpack__/pkg/react-spinners/GridLoader.js";import i from"../../__snowpack__/pkg/lodash/defaultsDeep.js";import{formatTime as g}from"../utils/index.js";import{useTranslation as R}from"../../__snowpack__/pkg/react-i18next.js";export var XAxisType;(function(r){r.value="value",r.log="log",r.time="time"})(XAxisType||(XAxisType={}));export var YAxisType;(function(r){r.value="value",r.log="log"})(YAxisType||(YAxisType={}));const Z=a.forwardRef(({options:r,data:l,title:s,loading:d,zoom:x,className:_,onInit:h},v)=>{const{i18n:n}=R(),{ref:w,echart:e,wrapper:y,saveAsImage:k}=T({loading:!!d,zoom:x,autoFit:!0,onInit:h}),m=G();return S(v,()=>({restore:()=>{e==null||e.dispatchAction({type:"restore"})},saveAsImage:()=>{k(s)}})),E(()=>{var u;const{color:p,series:A,...j}=b;if(!e)return;let o=i({title:{text:s!=null?s:""},xAxis:{splitLine:{show:!1},splitNumber:5},yAxis:{splitNumber:4},toolbox:{show:!0,showTitle:!1,itemSize:0,feature:{dataZoom:{show:!0}}},series:l==null?void 0:l.map((t,L)=>{var f,c;return i({showSymbol:((c=(f=t==null?void 0:t.data)==null?void 0:f.length)!=null?c:0)<=1,type:"line"},t,{lineStyle:{color:p[L%p.length],width:1.5}},A)})},r,m,j);((u=o==null?void 0:o.xAxis)==null?void 0:u.type)==="time"&&(o=i({xAxis:{axisLabel:{formatter:t=>g(t,n.language,"LTS")}}},o)),(o==null?void 0:o.yAxis).type==="time"&&(o=i({yAxis:{axisLabel:{formatter:t=>g(t,n.language,"LTS")}}},o)),e==null||e.setOption(o,{notMerge:!0}),e==null||e.dispatchAction({type:"takeGlobalCursor",key:"dataZoomSelect",dataZoomSelectActive:!0}),console.log("chartOptions",o)},[r,m,l,s,n.language,e]),a.createElement(N,{ref:y,className:_},!e&&a.createElement("div",{className:"loading"},a.createElement(I,{color:C,size:"10px"})),a.createElement("div",{className:"echarts",ref:w}))});export default Z;
